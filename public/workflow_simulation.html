<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Team Workflow Simulator</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* --- GIAO DI·ªÜN CYBERPUNK TRUNG T√çNH --- */
        :root {
            --bg-color: #0f172a;
            --card-bg: #1e293b;
            --text-color: #e2e8f0;
            --accent-user: #f59e0b;      /* User - Gold */
            --accent-plan: #3b82f6;      /* Architect - Blue */
            --accent-build: #10b981;     /* Coder - Green */
            --accent-memory: #d946ef;    /* Guardian - Magenta */
            --accent-genesis: #8b5cf6;   /* Genesis - Purple */
            --path-color: #475569;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        h1 {
            text-align: center;
            margin-bottom: 5px;
            background: linear-gradient(to right, var(--accent-plan), var(--accent-memory));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2.5rem;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        p.subtitle { color: #94a3b8; margin-top: 0; font-style: italic; }

        /* CONTROL BUTTONS */
        .controls { margin: 30px 0; display: flex; gap: 15px; flex-wrap: wrap; justify-content: center; }
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
            transition: all 0.2s;
            color: white;
            display: flex;
            align-items: center;
            gap: 8px;
            background-color: #334155;
            border: 1px solid #475569;
        }
        button:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.3); filter: brightness(1.1); }

        .btn-demo-new { background-color: var(--accent-plan); border-color: var(--accent-plan); }
        .btn-demo-fix { background-color: #ef4444; border-color: #ef4444; }
        .btn-guide { background-color: #64748b; border-color: #64748b; }
        
        /* N√∫t Genesis ƒë·∫∑c bi·ªát */
        .btn-genesis { 
            background: linear-gradient(135deg, var(--accent-genesis), var(--accent-memory)); 
            border: none; 
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.3);
        }
        .btn-genesis:hover {
            box-shadow: 0 0 25px rgba(139, 92, 246, 0.6);
        }

        /* STAGE (VISUALIZER) */
        .stage {
            position: relative;
            width: 100%;
            max-width: 900px;
            height: 400px;
            background: radial-gradient(circle at center, #1e293b 0%, #0f172a 70%);
            border-radius: 20px;
            border: 1px solid #334155;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            margin-bottom: 30px;
            overflow: hidden;
        }

        /* NODES */
        .node {
            position: absolute;
            width: 150px;
            padding: 15px;
            border-radius: 12px;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(5px);
            border: 2px solid transparent;
            text-align: center;
            transition: all 0.3s ease;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        .node i { font-size: 2rem; margin-bottom: 5px; }
        .node h3 { margin: 0; font-size: 0.9rem; font-weight: 800; text-transform: uppercase; }
        .node .role { font-size: 0.7rem; opacity: 0.8; }

        /* NODE SPECIFIC STYLES */
        #node-user { top: 20px; left: 50%; transform: translateX(-50%); border-color: var(--accent-user); color: var(--accent-user); }
        #node-architect { top: 160px; left: 60px; border-color: var(--accent-plan); color: var(--accent-plan); }
        #node-guardian { top: 160px; right: 60px; border-color: var(--accent-memory); color: var(--accent-memory); }
        #node-coder { bottom: 30px; left: 50%; transform: translateX(-50%); border-color: var(--accent-build); color: var(--accent-build); }

        /* ANIMATION STATES */
        .active-node { transform: scale(1.15) translateX(0) !important; z-index: 10; box-shadow: 0 0 30px currentColor; background: #1e293b; }
        #node-user.active-node { transform: translateX(-50%) scale(1.15) !important; }
        #node-coder.active-node { transform: translateX(-50%) scale(1.15) !important; }

        /* CONNECTORS */
        svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }
        path { fill: none; stroke: var(--path-color); stroke-width: 2; stroke-dasharray: 5; opacity: 0.6; }
        
        /* PACKET ANIMATION */
        .packet {
            position: absolute;
            width: 10px; height: 10px;
            background-color: white;
            border-radius: 50%;
            box-shadow: 0 0 10px white;
            z-index: 5;
            display: none;
            transition: left 1s linear, top 1s linear;
        }

        /* BUILDER SECTION */
        .builder-section {
            width: 100%;
            max-width: 900px;
            background-color: var(--card-bg);
            border-radius: 16px;
            padding: 25px;
            border: 1px solid #334155;
            margin-bottom: 40px;
        }

        .section-title {
            margin-top: 0;
            color: white;
            border-bottom: 1px solid #334155;
            padding-bottom: 15px;
            margin-bottom: 20px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: space-between; /* Chia ƒë√¥i ti√™u ƒë·ªÅ */
        }

        .builder-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
        
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 8px; color: #94a3b8; font-size: 0.85rem; font-weight: bold; text-transform: uppercase; }
        .input-group input, .input-group textarea {
            width: 100%;
            background-color: #0f172a;
            border: 1px solid #334155;
            color: #e2e8f0;
            padding: 12px;
            border-radius: 8px;
            font-family: 'Segoe UI', sans-serif;
            box-sizing: border-box;
            transition: border-color 0.2s;
        }
        .input-group input:focus, .input-group textarea:focus { border-color: var(--accent-plan); outline: none; }
        .input-group textarea { height: 80px; resize: vertical; }

        .btn-generate { width: 100%; justify-content: center; margin-top: 10px; }
        .btn-copy { background-color: #475569; width: 100%; justify-content: center; margin-top: 10px; }
        
        .output-area {
            width: 100%;
            height: 320px;
            background-color: #0b1120;
            color: #a5b4fc;
            border: 1px solid #334155;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            resize: none;
            box-sizing: border-box;
            line-height: 1.5;
        }

        /* MODAL */
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); backdrop-filter: blur(5px); }
        .modal-content { background-color: var(--card-bg); margin: 8% auto; padding: 30px; border-radius: 16px; width: 90%; max-width: 600px; border: 1px solid #475569; }
        .close-modal { float: right; font-size: 24px; cursor: pointer; color: #94a3b8; }
        
        @media (max-width: 768px) {
            .builder-grid { grid-template-columns: 1fr; }
            .stage { height: 550px; }
            #node-architect { top: 140px; left: 50%; transform: translateX(-50%); }
            #node-guardian { top: 280px; left: 50%; transform: translateX(-50%); }
            #node-coder { bottom: 20px; }
            .section-title { flex-direction: column; align-items: flex-start; gap: 10px; }
        }
    </style>
</head>
<body>

    <h1>AI Team Workflow Simulator</h1>
    <p class="subtitle">M√¥ h√¨nh t∆∞∆°ng t√°c ƒêa t√°c t·ª≠: User - Architect - Coder - Guardian</p>

    <!-- 1. CONTROLS -->
    <div class="controls">
        <button class="btn-demo-new" onclick="startScenario('feature')">
            <i class="fas fa-play-circle"></i> Demo: T√≠nh NƒÉng
        </button>
        <button class="btn-demo-fix" onclick="startScenario('bug')">
            <i class="fas fa-bug"></i> Demo: S·ª≠a L·ªói
        </button>
        <button class="btn-guide" onclick="openModal()">
            <i class="fas fa-info-circle"></i> Nguy√™n L√Ω
        </button>
        <!-- LINK TO GENESIS -->
        <button class="btn-genesis" onclick="window.open('https://hethongthongminh.id.vn/ai_setup', '_blank')">
            <i class="fas fa-rocket"></i> Kh·ªüi T·∫°o D·ª± √Ån (Genesis V2)
        </button>
    </div>

    <!-- 2. VISUALIZER STAGE -->
    <div class="stage">
        <svg>
            <!-- Path Visuals -->
            <path id="path-1" d="M450 90 L135 160" />  <!-- User -> Arch -->
            <path id="path-2" d="M135 290 L450 370" /> <!-- Arch -> Coder -->
            <path id="path-3" d="M450 370 L765 290" /> <!-- Coder -> Guard -->
            <path id="path-4" d="M765 160 L450 90" />  <!-- Guard -> User -->
            <!-- Bug Fix Flow -->
            <path id="path-5" d="M450 90 L765 160" /> <!-- User -> Guard -->
            <path id="path-6" d="M765 160 L135 160" /> <!-- Guard -> Arch -->
        </svg>

        <!-- NODES -->
        <div id="node-user" class="node">
            <i class="fas fa-user-astronaut"></i>
            <h3>USER</h3>
            <span class="role">RA L·ªÜNH & √ù T∆Ø·ªûNG</span>
        </div>

        <div id="node-architect" class="node">
            <i class="fas fa-drafting-compass"></i>
            <h3>ARCHITECT</h3>
            <span class="role">PLANNING & PROMPT</span>
        </div>

        <div id="node-guardian" class="node">
            <i class="fas fa-shield-alt"></i>
            <h3>GUARDIAN</h3>
            <span class="role">MEMORY & QA</span>
        </div>

        <div id="node-coder" class="node">
            <i class="fas fa-laptop-code"></i>
            <h3>CODER</h3>
            <span class="role">EXECUTION (CURSOR)</span>
        </div>

        <!-- Flying Packet -->
        <div id="packet" class="packet"></div>
    </div>

    <!-- 3. TOOLBOX (PROMPT BUILDER) -->
    <div class="builder-section">
        <div class="section-title">
            <div><i class="fas fa-tools"></i> C√¥ng C·ª• T√°c Nghi·ªáp H√†ng Ng√†y</div>
            <a href="https://hethongthongminh.id.vn/ai_setup" target="_blank" style="font-size: 0.85rem; color: #94a3b8; text-decoration: none; font-weight: normal; border: 1px solid #475569; padding: 5px 10px; border-radius: 5px;">
                <i class="fas fa-external-link-alt"></i> C·∫ßn Setup m·ªõi? ƒê·∫øn Genesis
            </a>
        </div>
        
        <div class="builder-grid">
            <!-- INPUTS -->
            <div>
                <div class="input-group">
                    <label>1. D·ª± √°n / Context:</label>
                    <input type="text" id="projectContext" placeholder="V√≠ d·ª•: App Th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠ (React/NodeJS)">
                </div>
                <div class="input-group">
                    <label>2. Y√™u c·∫ßu c·ªßa b·∫°n:</label>
                    <textarea id="userRequest" placeholder="V√≠ d·ª•: Th√™m ch·ª©c nƒÉng ƒëƒÉng nh·∫≠p b·∫±ng Google..."></textarea>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <button class="btn-generate" style="background: var(--accent-plan)" onclick="generatePrompt('architect')">
                        <i class="fas fa-magic"></i> T·∫°o Prompt Code
                    </button>
                    <button class="btn-generate" style="background: var(--accent-memory)" onclick="generatePrompt('guardian')">
                        <i class="fas fa-save"></i> T·∫°o Prompt L∆∞u
                    </button>
                </div>
            </div>

            <!-- OUTPUT -->
            <div>
                <label style="color: #94a3b8; font-weight: bold; font-size: 0.85rem; display:block; margin-bottom:8px;">K·∫æT QU·∫¢ (Copy v√†o AI):</label>
                <textarea id="outputArea" class="output-area" readonly placeholder="Prompt s·∫Ω xu·∫•t hi·ªán t·∫°i ƒë√¢y..."></textarea>
                <button class="btn-copy" onclick="copyOutput()">
                    <i class="fas fa-copy"></i> Sao ch√©p ngay
                </button>
            </div>
        </div>
    </div>

    <!-- INFO MODAL -->
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h2 style="color: white; border-bottom: 1px solid #475569; padding-bottom: 10px;">Lu·ªìng X·ª≠ L√Ω T√°c T·ª≠ H·ªá Th·ªëng</h2>
            <div style="color: #e2e8f0; line-height: 1.6;">
                <p>M√¥ h√¨nh n√†y gi√∫p b·∫°n gi·ªØ ng·ªØ c·∫£nh v√† ki·ªÉm so√°t ch·∫•t l∆∞·ª£ng khi l√†m vi·ªác v·ªõi AI:</p>
                <ul>
                    <li><strong style="color: var(--accent-user)">1. USER (B·∫°n):</strong> Ch·ªâ t·∫≠p trung v√†o Logic nghi·ªáp v·ª•. Kh√¥ng c·∫ßn nh·ªõ c√∫ ph√°p code.</li>
                    <li><strong style="color: var(--accent-plan)">2. ARCHITECT (AI 1):</strong> Nh·∫≠n l·ªánh th√¥ s∆° t·ª´ b·∫°n -> Vi·∫øt b·∫£n v·∫Ω k·ªπ thu·∫≠t (Prompt) chi ti·∫øt cho Coder.</li>
                    <li><strong style="color: var(--accent-build)">3. CODER (AI 2):</strong> Nh·∫≠n b·∫£n v·∫Ω -> Thi c√¥ng (Vi·∫øt code). Th∆∞·ªùng l√† IDE nh∆∞ Cursor/Windsurf.</li>
                    <li><strong style="color: var(--accent-memory)">4. GUARDIAN (AI 3):</strong> Nghi·ªám thu code -> C·∫≠p nh·∫≠t h·ªì s∆° d·ª± √°n (Memory Bank). ƒê·∫£m b·∫£o kh√¥ng b·ªã "·∫£o gi√°c" ·ªü c√°c b∆∞·ªõc sau.</li>
                </ul>
                <p style="margin-top: 20px; border-top: 1px dashed #475569; padding-top: 15px;">
                    <strong style="color: var(--accent-genesis)">üöÄ M·∫∏O:</strong> D√πng c√¥ng c·ª• <strong>Project Genesis</strong> (n√∫t m√†u t√≠m) ƒë·ªÉ kh·ªüi t·∫°o b·ªô Prompt chu·∫©n cho 3 vai tr√≤ n√†y tr∆∞·ªõc khi b·∫Øt ƒë·∫ßu d·ª± √°n m·ªõi.
                </p>
            </div>
        </div>
    </div>

    <script>
        // --- VISUALIZATION LOGIC ---
        function getPos(id) {
            const el = document.getElementById(id);
            const rect = el.getBoundingClientRect();
            const stageRect = document.querySelector('.stage').getBoundingClientRect();
            return { x: rect.left - stageRect.left + rect.width/2, y: rect.top - stageRect.top + rect.height/2 };
        }

        function animateNode(id) {
            const el = document.getElementById(id);
            el.classList.add('active-node');
            setTimeout(() => el.classList.remove('active-node'), 600);
        }

        async function movePacket(from, to) {
            const packet = document.getElementById('packet');
            const start = getPos(from);
            const end = getPos(to);
            
            packet.style.display = 'block';
            packet.style.left = start.x + 'px';
            packet.style.top = start.y + 'px';
            
            // Force reflow
            void packet.offsetWidth; 

            packet.style.left = end.x + 'px';
            packet.style.top = end.y + 'px';
            
            await new Promise(r => setTimeout(r, 1000));
            packet.style.display = 'none';
        }

        async function startScenario(type) {
            if (type === 'feature') {
                // Flow: User -> Arch -> Coder -> Guardian
                animateNode('node-user'); await new Promise(r => setTimeout(r, 500));
                await movePacket('node-user', 'node-architect');
                animateNode('node-architect'); await new Promise(r => setTimeout(r, 500));
                await movePacket('node-architect', 'node-coder');
                animateNode('node-coder'); await new Promise(r => setTimeout(r, 500));
                await movePacket('node-coder', 'node-guardian');
                animateNode('node-guardian');
            } else {
                // Flow: User -> Guardian (Check) -> Architect -> Coder -> Guardian
                // Step 1: User reports bug to Guardian
                animateNode('node-user'); await new Promise(r => setTimeout(r, 500));
                await movePacket('node-user', 'node-guardian');
                
                // Step 2: Guardian checks and sends info to Architect
                animateNode('node-guardian'); await new Promise(r => setTimeout(r, 500));
                await movePacket('node-guardian', 'node-architect');
                
                // Step 3: Architect creates fix prompt
                animateNode('node-architect'); await new Promise(r => setTimeout(r, 500));
                await movePacket('node-architect', 'node-coder');
                
                // Step 4: Coder executes fix
                animateNode('node-coder'); await new Promise(r => setTimeout(r, 500));
                await movePacket('node-coder', 'node-guardian');
                
                // Step 5: Guardian verifies and updates memory
                animateNode('node-guardian');
            }
        }

        // --- PROMPT BUILDER LOGIC ---
        const outputArea = document.getElementById('outputArea');
        const projectContext = document.getElementById('projectContext');
        const userRequest = document.getElementById('userRequest');

        function generatePrompt(role) {
            const context = projectContext.value || "[T√™n D·ª± √Ån]";
            const req = userRequest.value || "[Y√™u c·∫ßu c·ªßa b·∫°n]";

            if (role === 'architect') {
                outputArea.value = `# NHI·ªÜM V·ª§: ${req.toUpperCase()} FOR ${context}

B·∫°n l√† Prompt Architect. H√£y vi·∫øt prompt k·ªπ thu·∫≠t cho Coder d·ª±a tr√™n:

1. **Context D·ª± √Ån:** ${context}
2. **Y√™u c·∫ßu User:** "${req}"

3. **Y√™u c·∫ßu Output:**
- Vi·∫øt prompt chi ti·∫øt (T√™n file, t√™n h√†m, th∆∞ vi·ªán).
- Tu√¢n th·ªß ki·∫øn tr√∫c hi·ªán t·∫°i c·ªßa d·ª± √°n.
- Ch·ªâ d√πng code block cho ph·∫ßn Prompt cu·ªëi c√πng.`;
                animateNode('node-architect');
            } else {
                outputArea.value = `# Y√äU C·∫¶U C·∫¨P NH·∫¨T MEMORY BANK

T√¥i v·ª´a ho√†n th√†nh task code cho d·ª± √°n: ${context}
N·ªôi dung: "${req}"

H√£y th·ª±c hi·ªán quy tr√¨nh QA & Update:
1. Ki·ªÉm tra code t√¥i cung c·∫•p (s·∫Øp paste) c√≥ kh·ªõp y√™u c·∫ßu kh√¥ng?
2. N·∫øu kh·ªõp, c·∫≠p nh·∫≠t tr·∫°ng th√°i v√†o activeContext.md v√† progress.md.
3. N·∫øu sai, c·∫£nh b√°o ngay.`;
                animateNode('node-guardian');
            }
        }

        function copyOutput() {
            navigator.clipboard.writeText(outputArea.value);
            const btn = document.querySelector('.btn-copy');
            const original = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-check"></i> ƒê√£ Copy!';
            setTimeout(() => btn.innerHTML = original, 2000);
        }

        // --- MODAL ---
        const modal = document.getElementById('infoModal');
        function openModal() { modal.style.display = 'block'; }
        function closeModal() { modal.style.display = 'none'; }
        window.onclick = e => { if(e.target == modal) closeModal(); }
    </script>
</body>
</html>