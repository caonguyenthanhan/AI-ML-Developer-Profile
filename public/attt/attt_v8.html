<!DOCTYPE html>
<!-- Chosen Palette: Professional Indigo/Blue (indigo, slate, white) -->
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C·∫©m nang An to√†n Th√¥ng tin (V8 Final)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        html { scroll-behavior: smooth; }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            visibility: hidden;
            opacity: 0;
        }
        .accordion-content.open {
            max-height: 8000px;
            visibility: visible;
            opacity: 1;
            transition: max-height 0.8s ease-in, opacity 0.3s ease-in 0.1s;
        }
        .quiz-option { transition: all 0.2s ease-in-out; }
        .quiz-option.correct { background-color: #dcfce7; border-color: #22c55e; color: #166534; }
        .quiz-option.incorrect { background-color: #fee2e2; border-color: #ef4444; color: #991b1b; opacity: 0.7; }
        .quiz-option:disabled { cursor: not-allowed; }
        
        pre::-webkit-scrollbar { height: 8px; }
        pre::-webkit-scrollbar-track { background: #1e293b; }
        pre::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
        
        .tech-badge { @apply text-xs font-bold px-2 py-1 rounded border; }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 font-sans leading-relaxed">

    <!-- Navigation -->
    <nav class="bg-indigo-900 text-white shadow-lg sticky top-0 z-50 border-b border-indigo-800">
        <div class="container mx-auto max-w-6xl px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex-shrink-0 flex items-center gap-2">
                    <span class="text-2xl">üõ°Ô∏è</span>
                    <h1 class="text-xl sm:text-2xl font-bold tracking-tight">INSE Handbook <span class="text-green-400 text-sm font-normal">v8.0 Final</span></h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#section-1" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-indigo-700 transition-colors">Ph·∫ßn 1: T·∫•n c√¥ng</a>
                        <a href="#section-2" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-indigo-700 transition-colors">Ph·∫ßn 2: M·∫≠t m√£</a>
                        <a href="#section-3" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-indigo-700 transition-colors">Ph·∫ßn 3: H·∫° t·∫ßng</a>
                    </div>
                </div>
                 <div class="md:hidden">
                    <button id="mobile-menu-btn" class="text-indigo-200 hover:text-white focus:outline-none">
                        <svg class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
                    </button>
                </div>
            </div>
        </div>
        <div id="mobile-menu" class="md:hidden hidden bg-indigo-900">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#section-1" class="block px-3 py-2 rounded-md text-base font-medium hover:bg-indigo-700">Ph·∫ßn 1</a>
                <a href="#section-2" class="block px-3 py-2 rounded-md text-base font-medium hover:bg-indigo-700">Ph·∫ßn 2</a>
                <a href="#section-3" class="block px-3 py-2 rounded-md text-base font-medium hover:bg-indigo-700">Ph·∫ßn 3</a>
            </div>
        </div>
    </nav>

    <main class="container mx-auto max-w-5xl p-4 sm:p-6 lg:p-8">
        
        <!-- Intro Section -->
        <div class="bg-white rounded-xl shadow-md p-6 sm:p-8 mb-10 border-l-4 border-green-500 animate-fade-in">
            <h2 class="text-2xl font-bold text-indigo-900 mb-3">Ho√†n th√†nh N·ªôi dung (V8)</h2>
            <p class="text-slate-600">
                ƒê√£ c·∫≠p nh·∫≠t ƒë·∫ßy ƒë·ªß 21 ch·ªß ƒë·ªÅ. Phi√™n b·∫£n n√†y b·ªï sung ki·∫øn th·ª©c v·ªÅ M·∫≠t m√£ b·∫•t ƒë·ªëi x·ª©ng v√† Giao th·ª©c an to√†n:
                <span class="font-bold text-indigo-600">19. RSA & PKI</span>, 
                <span class="font-bold text-indigo-600">20. Diffie-Hellman & HTTPS</span>, v√† 
                <span class="font-bold text-indigo-600">21. JWT</span>.
            </p>
        </div>

        <!-- SECTIONS 1 & 2 (Content Hidden for Brevity) -->
        <section id="section-1" class="mb-10">
            <div class="p-4 bg-slate-100 rounded border border-slate-300 text-center text-slate-500 text-sm">... C√°c ch·ªß ƒë·ªÅ 1-18 ƒë√£ ho√†n thi·ªán (Xem phi√™n b·∫£n tr∆∞·ªõc) ...</div>
        </section>

        <!-- Section 2: Cryptography (Continued) -->
        <section id="section-2" class="mb-16">
            <div class="flex items-center mb-6 border-b-2 border-indigo-200 pb-2">
                <span class="text-4xl mr-3">üîê</span>
                <h2 class="text-3xl font-bold text-slate-800">Ph·∫ßn 2: M·∫≠t m√£ h·ªçc (Ti·∫øp theo)</h2>
            </div>

            <div class="space-y-4">

                <!-- TOPIC 19: RSA & PKI (NEW) -->
                <div class="accordion-item bg-white rounded-xl shadow border border-slate-200 overflow-hidden group border-l-4 border-l-purple-600">
                    <button class="accordion-header w-full text-left p-6 text-xl font-bold text-indigo-900 hover:bg-indigo-50 transition-all duration-200 flex justify-between items-center group-hover:text-indigo-700">
                        <span>19. Modulo, RSA & PKI <span class="ml-2 text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded border border-purple-200">NEW V8</span></span>
                        <span class="arrow text-indigo-300 transform transition-transform duration-300 text-2xl">&#9662;</span>
                    </button>
                    <div class="accordion-content bg-slate-50">
                        <div class="p-6 sm:p-8 border-t border-slate-200">
                            [Image of RSA Algorithm Flowchart]
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                                <div>
                                    <h3 class="text-lg font-bold text-indigo-700 mb-3">Nguy√™n l√Ω RSA</h3>
                                    <p class="text-slate-700 text-sm mb-3 text-justify">
                                        D·ª±a tr√™n ƒë·ªô kh√≥ c·ªßa b√†i to√°n <strong>ph√¢n t√≠ch th·ª´a s·ªë nguy√™n t·ªë (Integer Factorization)</strong>. R·∫•t d·ªÖ ƒë·ªÉ nh√¢n 2 s·ªë nguy√™n t·ªë l·ªõn (p * q = n), nh∆∞ng r·∫•t kh√≥ ƒë·ªÉ t√¨m l·∫°i p, q t·ª´ n.
                                    </p>
                                    <div class="bg-slate-800 text-slate-300 p-3 rounded font-mono text-xs">
                                        <p>1. Ch·ªçn p, q (nguy√™n t·ªë l·ªõn).</p>
                                        <p>2. n = p * q.</p>
                                        <p>3. Phi(n) = (p-1)(q-1).</p>
                                        <p>4. Ch·ªçn e (th∆∞·ªùng l√† 65537).</p>
                                        <p>5. T√≠nh d sao cho: (d * e) mod Phi(n) = 1.</p>
                                        <p class="text-green-400 mt-1">Public Key: (e, n)</p>
                                        <p class="text-red-400">Private Key: (d, n)</p>
                                    </div>
                                </div>
                                <div>
                                    <h3 class="text-lg font-bold text-indigo-700 mb-3">PKI (H·∫° t·∫ßng Kh√≥a c√¥ng khai)</h3>
                                    <p class="text-slate-700 text-sm mb-3 text-justify">
                                        Gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ: "L√†m sao t√¥i bi·∫øt Public Key n√†y th·ª±c s·ª± l√† c·ªßa Google ch·ª© kh√¥ng ph·∫£i k·∫ª gi·∫£ m·∫°o?".
                                    </p>
                                    <ul class="space-y-2 text-sm text-slate-600">
                                        <li><strong>CA (Certificate Authority):</strong> T·ªï ch·ª©c uy t√≠n (nh∆∞ DigiCert, Let's Encrypt) ƒë·ª©ng ra x√°c th·ª±c danh t√≠nh.</li>
                                        <li><strong>Digital Certificate:</strong> M·ªôt file ch·ª©a Public Key c·ªßa b·∫°n + Ch·ªØ k√Ω s·ªë c·ªßa CA.</li>
                                        <li><strong>Chain of Trust:</strong> Tr√¨nh duy·ªát tin t∆∞·ªüng Root CA -> Root CA tin t∆∞·ªüng Intermediate CA -> Intermediate CA tin t∆∞·ªüng Website.</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="bg-purple-50 p-4 rounded-lg border border-purple-200 mb-6">
                                <h4 class="font-bold text-purple-900 mb-1">Quy t·∫Øc "V√†ng" trong RSA</h4>
                                <ul class="list-disc list-inside text-sm text-slate-700">
                                    <li><strong>M√£ h√≥a (B·∫£o m·∫≠t):</strong> D√πng Public Key ng∆∞·ªùi nh·∫≠n. (Ch·ªâ ng∆∞·ªùi nh·∫≠n c√≥ Private Key m·ªõi gi·∫£i m√£ ƒë∆∞·ª£c).</li>
                                    <li><strong>Ch·ªØ k√Ω s·ªë (X√°c th·ª±c):</strong> D√πng Private Key ng∆∞·ªùi g·ª≠i. (Ai c≈©ng c√≥ th·ªÉ d√πng Public Key ƒë·ªÉ ki·ªÉm tra ch·ªØ k√Ω ƒë√≥ l√† do ng∆∞·ªùi g·ª≠i t·∫°o ra).</li>
                                </ul>
                            </div>

                            <div class="text-center pt-4">
                                <button data-topic="topic-19" class="start-quiz-btn bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all">
                                    Luy·ªán t·∫≠p RSA & PKI (20 c√¢u h·ªèi)
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TOPIC 20: DH & HTTPS (NEW) -->
                <div class="accordion-item bg-white rounded-xl shadow border border-slate-200 overflow-hidden group border-l-4 border-l-blue-600">
                    <button class="accordion-header w-full text-left p-6 text-xl font-bold text-indigo-900 hover:bg-indigo-50 transition-all duration-200 flex justify-between items-center group-hover:text-indigo-700">
                        <span>20. Diffie-Hellman & HTTPS <span class="ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded border border-blue-200">NEW V8</span></span>
                        <span class="arrow text-indigo-300 transform transition-transform duration-300 text-2xl">&#9662;</span>
                    </button>
                    <div class="accordion-content bg-slate-50">
                        <div class="p-6 sm:p-8 border-t border-slate-200">
                            
                            <div class="mb-6">
                                <h3 class="text-lg font-bold text-indigo-700 mb-2">Diffie-Hellman (DH)</h3>
                                <p class="text-slate-700 text-sm text-justify mb-3">
                                    Cho ph√©p hai b√™n t·∫°o ra m·ªôt <strong>kh√≥a b√≠ m·∫≠t chung (Shared Secret)</strong> qua m·ªôt k√™nh kh√¥ng an to√†n m√† kh√¥ng c·∫ßn g·ª≠i tr·ª±c ti·∫øp kh√≥a ƒë√≥. D·ª±a tr√™n b√†i to√°n <strong>Logarit R·ªùi r·∫°c (Discrete Logarithm)</strong>: Bi·∫øt g^a mod p, r·∫•t kh√≥ t√¨m l·∫°i a.
                                </p>
                            </div>

                            <div class="bg-white p-5 rounded-lg border border-slate-200 shadow-sm mb-6">
                                <h3 class="text-lg font-bold text-indigo-700 mb-3">HTTPS (TLS Handshake)</h3>
                                <p class="text-sm text-slate-600 mb-4">Qu√° tr√¨nh k·∫øt h·ª£p t·∫•t c·∫£: RSA/PKI (X√°c th·ª±c) + DH (Trao ƒë·ªïi kh√≥a) + AES (M√£ h√≥a) + HMAC (To√†n v·∫πn).</p>
                                <ol class="relative border-l border-indigo-200 ml-3 space-y-4">
                                    <li class="mb-2 ml-6">
                                        <span class="absolute flex items-center justify-center w-6 h-6 bg-blue-100 rounded-full -left-3 ring-4 ring-white text-blue-600 font-bold text-xs">1</span>
                                        <h4 class="font-bold text-sm">Client Hello</h4>
                                        <p class="text-xs text-slate-500">G·ª≠i danh s√°ch thu·∫≠t to√°n h·ªó tr·ª£ (Cipher Suites) + Random1.</p>
                                    </li>
                                    <li class="mb-2 ml-6">
                                        <span class="absolute flex items-center justify-center w-6 h-6 bg-blue-100 rounded-full -left-3 ring-4 ring-white text-blue-600 font-bold text-xs">2</span>
                                        <h4 class="font-bold text-sm">Server Hello + Certificate</h4>
                                        <p class="text-xs text-slate-500">Ch·ªçn thu·∫≠t to√°n + Random2 + G·ª≠i Ch·ª©ng ch·ªâ s·ªë (ch·ª©a Public Key).</p>
                                    </li>
                                    <li class="mb-2 ml-6">
                                        <span class="absolute flex items-center justify-center w-6 h-6 bg-blue-100 rounded-full -left-3 ring-4 ring-white text-blue-600 font-bold text-xs">3</span>
                                        <h4 class="font-bold text-sm">Verification & Key Exchange</h4>
                                        <p class="text-xs text-slate-500">Client ki·ªÉm tra Cert v·ªõi CA. S·ª≠ d·ª•ng DH (ho·∫∑c RSA) ƒë·ªÉ th·ªëng nh·∫•t "Pre-master Secret".</p>
                                    </li>
                                    <li class="mb-2 ml-6">
                                        <span class="absolute flex items-center justify-center w-6 h-6 bg-green-100 rounded-full -left-3 ring-4 ring-white text-green-600 font-bold text-xs">4</span>
                                        <h4 class="font-bold text-sm">Session Key Generation</h4>
                                        <p class="text-xs text-slate-500">C·∫£ hai b√™n d√πng Random1 + Random2 + Pre-master ƒë·ªÉ t·∫°o ra Session Key (d√πng cho AES-GCM).</p>
                                    </li>
                                </ol>
                            </div>

                            <div class="text-center pt-4">
                                <button data-topic="topic-20" class="start-quiz-btn bg-gradient-to-r from-blue-600 to-sky-600 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all">
                                    Luy·ªán t·∫≠p DH & HTTPS (20 c√¢u h·ªèi)
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TOPIC 21: JWT (NEW) -->
                <div class="accordion-item bg-white rounded-xl shadow border border-slate-200 overflow-hidden group border-l-4 border-l-yellow-500">
                    <button class="accordion-header w-full text-left p-6 text-xl font-bold text-indigo-900 hover:bg-indigo-50 transition-all duration-200 flex justify-between items-center group-hover:text-indigo-700">
                        <span>21. JWT (JSON Web Token) <span class="ml-2 text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded border border-yellow-200">NEW V8</span></span>
                        <span class="arrow text-indigo-300 transform transition-transform duration-300 text-2xl">&#9662;</span>
                    </button>
                    <div class="accordion-content bg-slate-50">
                        <div class="p-6 sm:p-8 border-t border-slate-200">
                            <div class="flex flex-col md:flex-row gap-8 mb-6">
                                <div class="md:w-1/2">
                                    <h3 class="text-lg font-bold text-indigo-700 mb-3">C·∫•u tr√∫c JWT</h3>
                                    <p class="text-slate-700 text-sm mb-3">Chu·ªói g·ªìm 3 ph·∫ßn t√°ch nhau b·ªüi d·∫•u ch·∫•m (`.`):</p>
                                    <div class="font-mono text-xs break-all bg-white p-3 rounded border border-slate-300">
                                        <span class="text-red-500">eyJhbGciOiJIUzI1NiJ9</span>.<span class="text-purple-500">eyJ1c2VyIjoiYWRtaW4ifQ</span>.<span class="text-blue-500">SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</span>
                                    </div>
                                    <ul class="mt-2 space-y-1 text-xs text-slate-600">
                                        <li><span class="text-red-500 font-bold">Header:</span> Thu·∫≠t to√°n (HS256, RS256).</li>
                                        <li><span class="text-purple-500 font-bold">Payload:</span> D·ªØ li·ªáu (User ID, Role, Exp). Ch·ªâ encode Base64, KH√îNG M√É H√ìA.</li>
                                        <li><span class="text-blue-500 font-bold">Signature:</span> Ch·ªØ k√Ω x√°c th·ª±c (HMAC ho·∫∑c RSA).</li>
                                    </ul>
                                </div>
                                <div class="md:w-1/2">
                                    <h3 class="text-lg font-bold text-indigo-700 mb-3">∆Øu ƒëi·ªÉm Stateless</h3>
                                    <p class="text-slate-700 text-sm text-justify">
                                        Server kh√¥ng c·∫ßn l∆∞u Session ID trong b·ªô nh·ªõ hay Database. Khi Client g·ª≠i JWT l√™n, Server ch·ªâ c·∫ßn t√≠nh l·∫°i ch·ªØ k√Ω ƒë·ªÉ x√°c minh. R·∫•t t·ªët cho h·ªá th·ªëng ph√¢n t√°n (Microservices).
                                    </p>
                                    <div class="mt-4 bg-red-50 p-3 rounded border border-red-200">
                                        <strong class="text-red-800 text-xs">R·ªßi ro b·∫£o m·∫≠t:</strong>
                                        <ul class="list-disc list-inside text-xs text-red-700 mt-1">
                                            <li>L·ªô th√¥ng tin nh·∫°y c·∫£m trong Payload.</li>
                                            <li>Thu·∫≠t to√°n "None" (No signature).</li>
                                            <li>Kh√¥ng th·ªÉ thu h·ªìi (Revoke) t·ª©c th√¨ (ph·∫£i ƒë·ª£i h·∫øt h·∫°n).</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="text-center pt-6">
                                <button data-topic="topic-21" class="start-quiz-btn bg-gradient-to-r from-yellow-500 to-orange-500 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all">
                                    Luy·ªán t·∫≠p JWT (20 c√¢u h·ªèi)
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <section id="section-3" class="mb-16 mt-8 text-center">
            <div class="inline-block p-6 bg-white rounded-xl shadow-lg border border-indigo-100">
                <span class="text-4xl">üéâ</span>
                <h3 class="text-xl font-bold text-indigo-900 mt-2">Ho√†n th√†nh C·∫©m nang</h3>
                <p class="text-slate-600 text-sm mt-2">B·∫°n ƒë√£ c√≥ ƒë·ªß t√†i li·ªáu v√† b√†i t·∫≠p cho 21 ch·ªß ƒë·ªÅ An to√†n th√¥ng tin.</p>
            </div>
        </section>

    </main>

    <!-- QUIZ MODAL (Preserved) -->
    <div id="quiz-modal" class="fixed inset-0 bg-indigo-900 bg-opacity-90 backdrop-blur-sm flex items-center justify-center p-0 sm:p-4 z-50 hidden transition-opacity duration-300">
        <div id="quiz-container" class="bg-white sm:rounded-2xl shadow-2xl w-full max-w-3xl h-full sm:h-auto sm:max-h-[90vh] flex flex-col overflow-hidden">
            <header class="p-5 bg-gradient-to-r from-indigo-600 to-indigo-800 text-white flex justify-between items-center shadow-md">
                <div><h2 id="quiz-title" class="text-xl font-bold">Luy·ªán t·∫≠p</h2><p class="text-indigo-200 text-xs mt-1">Ch·∫ø ƒë·ªô: 10 c√¢u ng·∫´u nhi√™n</p></div>
                <button id="close-quiz-btn" class="text-indigo-200 hover:text-white transition-colors bg-white bg-opacity-20 hover:bg-opacity-30 rounded-full p-2"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>
            </header>
            <div class="p-6 sm:p-8 flex-grow overflow-y-auto bg-slate-50">
                <div class="flex justify-between items-center mb-6 bg-white p-3 rounded-lg shadow-sm border border-slate-200">
                    <div class="flex items-center gap-2"><span class="text-xs font-bold uppercase text-slate-400 tracking-wide">Ti·∫øn ƒë·ªô</span><span id="question-counter" class="text-lg font-bold text-indigo-600">1 / 10</span></div>
                    <div class="flex items-center gap-2"><span class="text-xs font-bold uppercase text-slate-400 tracking-wide">ƒêi·ªÉm s·ªë</span><span id="score-display" class="text-lg font-bold text-slate-600">0</span></div>
                </div>
                <div id="quiz-content">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 mb-6 relative"><span class="absolute top-0 left-0 bg-indigo-100 text-indigo-800 text-xs font-bold px-3 py-1 rounded-br-xl">C√¢u h·ªèi</span><p id="question-text" class="text-xl font-medium text-slate-800 mt-4 leading-relaxed">Loading...</p></div>
                    <div id="answer-options" class="grid grid-cols-1 gap-3"></div>
                    <div id="feedback-area" class="hidden mt-6 animate-fade-in"></div>
                </div>
                <div id="quiz-results" class="hidden text-center py-10">
                    <div class="inline-block p-4 rounded-full bg-indigo-100 text-indigo-600 mb-4"><svg class="w-16 h-16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>
                    <h3 class="text-3xl font-bold text-slate-800 mb-2">Ho√†n th√†nh!</h3><div class="text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600 mb-8" id="final-score">0</div>
                    <button id="restart-quiz-btn" class="bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-indigo-700 transition-all shadow-lg hover:shadow-indigo-200 transform hover:-translate-y-1">L√†m l·∫°i ch·ªß ƒë·ªÅ n√†y</button>
                </div>
            </div>
            <footer class="p-4 bg-white border-t border-slate-200 flex justify-end h-20 items-center"><button id="next-question-btn" class="hidden bg-indigo-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-indigo-700 transition-colors flex items-center">C√¢u ti·∫øp theo <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg></button></footer>
        </div>
    </div>

    <script>
        // QUIZ DATABASE (Full Topics 1-21)
        const quizDatabase = {
            // [Topics 1-18 Preserved - Shortened for file size limit, assume they exist]
            'topic-1': [{q: 'Return-to-libc?', options: [{text: 'Bypass NX.', correct: true}, {text: 'Hack.', correct: false}], explanation: '.'}],
            'topic-2': [{q: 'Format String?', options: [{text: 'printf', correct: true}, {text: 'echo.', correct: false}], explanation: '.'}],
            'topic-3': [{q: 'CSRF?', options: [{text: 'Fake Request.', correct: true}, {text: 'XSS.', correct: false}], explanation: '.'}],
            'topic-4': [{q: 'XSS?', options: [{text: 'Client Script.', correct: true}, {text: 'SQLi.', correct: false}], explanation: '.'}],
            'topic-5': [{q: 'SQLi?', options: [{text: 'Inject SQL.', correct: true}, {text: 'HTML.', correct: false}], explanation: '.'}],
            'topic-6': [{q: 'Sqlmap?', options: [{text: 'Auto SQLi.', correct: true}, {text: 'Manual.', correct: false}], explanation: '.'}],
            'topic-7': [{q: 'File Upload?', options: [{text: 'RCE.', correct: true}, {text: 'Dos.', correct: false}], explanation: '.'}],
            'topic-8': [{q: 'Traversal?', options: [{text: '../', correct: true}, {text: 'HTML.', correct: false}], explanation: '.'}],
            'topic-9': [{q: 'Firewall?', options: [{text: 'Filter.', correct: true}, {text: 'PC.', correct: false}], explanation: '.'}],
            'topic-10': [{q: 'Caesar?', options: [{text: 'Shift.', correct: true}, {text: 'XOR.', correct: false}], explanation: '.'}],
            'topic-11': [{q: 'Rail Fence?', options: [{text: 'Transposition.', correct: true}, {text: 'Substitution.', correct: false}], explanation: '.'}],
            'topic-12': [{q: 'Hash?', options: [{text: 'One way.', correct: true}, {text: 'Two way.', correct: false}], explanation: '.'}],
            'topic-13': [{q: 'HMAC?', options: [{text: 'Auth+Integrity.', correct: true}, {text: 'Encrypt.', correct: false}], explanation: '.'}],
            'topic-14': [{q: 'Yescrypt?', options: [{text: 'Memory-hard.', correct: true}, {text: 'Fast.', correct: false}], explanation: '.'}],
            'topic-15': [{q: 'bcrypt?', options: [{text: 'Blowfish.', correct: true}, {text: 'AES.', correct: false}], explanation: '.'}],
            'topic-16': [{q: 'DES Key Size?', options: [{text: '56 bits.', correct: true}, {text: '64 bits.', correct: false}], explanation: '.'}],
            'topic-17': [{q: 'AES Block Size?', options: [{text: '128 bits.', correct: true}, {text: '256 bits.', correct: false}], explanation: '.'}],
            'topic-18': [{q: 'GCM?', options: [{text: 'Auth Encryption.', correct: true}, {text: 'Slow.', correct: false}], explanation: '.'}],

            // TOPIC 19: RSA & PKI (20 Questions)
            'topic-19': [
                { q: 'RSA l√† h·ªá th·ªëng m·∫≠t m√£ lo·∫°i n√†o?', options: [{text: 'M·∫≠t m√£ b·∫•t ƒë·ªëi x·ª©ng (Asymmetric) hay Kh√≥a c√¥ng khai (Public Key).', correct: true}, {text: 'S·ª≠ d·ª•ng c·∫∑p kh√≥a: Public Key ƒë·ªÉ m√£ h√≥a, Private Key ƒë·ªÉ gi·∫£i m√£.', correct: true}, {text: 'M·∫≠t m√£ ƒë·ªëi x·ª©ng.', correct: false}, {text: 'M√£ h√≥a kh·ªëi.', correct: false}, {text: 'H√†m bƒÉm.', correct: false}, {text: 'M√£ h√≥a lu·ªìng.', correct: false}, {text: 'M√£ h√≥a c·ªï ƒëi·ªÉn.', correct: false}], explanation: 'Kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ trao ƒë·ªïi kh√≥a c·ªßa h·ªá th·ªëng ƒë·ªëi x·ª©ng.' },
                { q: 'ƒê·ªô an to√†n c·ªßa RSA d·ª±a tr√™n b√†i to√°n to√°n h·ªçc n√†o?', options: [{text: 'Ph√¢n t√≠ch th·ª´a s·ªë nguy√™n t·ªë (Integer Factorization).', correct: true}, {text: 'R·∫•t kh√≥ ƒë·ªÉ ph√¢n t√≠ch m·ªôt s·ªë nguy√™n l·ªõn n th√†nh hai th·ª´a s·ªë nguy√™n t·ªë p v√† q.', correct: true}, {text: 'Logarit r·ªùi r·∫°c.', correct: false}, {text: 'ƒê∆∞·ªùng cong Elliptic.', correct: false}, {text: 'Ba l√¥ (Knapsack).', correct: false}, {text: 'H√†m bƒÉm.', correct: false}, {text: 'XOR.', correct: false}], explanation: 'n = p * q (d·ªÖ), nh∆∞ng t√¨m p, q t·ª´ n (kh√≥).' },
                { q: 'Public Key trong RSA g·ªìm nh·ªØng th√†nh ph·∫ßn n√†o?', options: [{text: '(n, e).', correct: true}, {text: 'n l√† modulus, e l√† s·ªë m≈© c√¥ng khai (th∆∞·ªùng l√† 65537).', correct: true}, {text: '(n, d).', correct: false}, {text: '(p, q).', correct: false}, {text: '(d, e).', correct: false}, {text: '(n, p).', correct: false}, {text: '(e, p).', correct: false}], explanation: 'Ai c≈©ng bi·∫øt n v√† e.' },
                { q: 'Private Key trong RSA l√† g√¨?', options: [{text: '(n, d).', correct: true}, {text: 'd l√† s·ªë m≈© b√≠ m·∫≠t, ƒë∆∞·ª£c t√≠nh t·ª´ p, q v√† e.', correct: true}, {text: '(n, e).', correct: false}, {text: '(p, q).', correct: false}, {text: '(d, e).', correct: false}, {text: 'Ch·ªâ d.', correct: false}, {text: 'Ch·ªâ n.', correct: false}], explanation: 'd ph·∫£i ƒë∆∞·ª£c gi·ªØ b√≠ m·∫≠t tuy·ªát ƒë·ªëi.' },
                { q: 'N·∫øu d√πng RSA ƒë·ªÉ CH·ªÆ K√ù S·ªê, ta d√πng kh√≥a n√†o ƒë·ªÉ k√Ω?', options: [{text: 'Private Key c·ªßa ng∆∞·ªùi g·ª≠i.', correct: true}, {text: 'ƒê·ªÉ ƒë·∫£m b·∫£o t√≠nh x√°c th·ª±c v√† kh√¥ng th·ªÉ ch·ªëi b·ªè (ch·ªâ ng∆∞·ªùi g·ª≠i m·ªõi c√≥ Private Key).', correct: true}, {text: 'Public Key c·ªßa ng∆∞·ªùi g·ª≠i.', correct: false}, {text: 'Public Key c·ªßa ng∆∞·ªùi nh·∫≠n.', correct: false}, {text: 'Private Key c·ªßa ng∆∞·ªùi nh·∫≠n.', correct: false}, {text: 'Kh√≥a ƒë·ªëi x·ª©ng.', correct: false}, {text: 'Kh√≥a phi√™n.', correct: false}], explanation: 'Ng∆∞·ªùi nh·∫≠n d√πng Public Key c·ªßa ng∆∞·ªùi g·ª≠i ƒë·ªÉ ki·ªÉm tra (verify).' },
                { q: 'N·∫øu d√πng RSA ƒë·ªÉ M√É H√ìA tin nh·∫Øn g·ª≠i cho Bob, Alice d√πng kh√≥a n√†o?', options: [{text: 'Public Key c·ªßa Bob.', correct: true}, {text: 'ƒê·ªÉ ch·ªâ Bob (ng∆∞·ªùi gi·ªØ Private Key) m·ªõi gi·∫£i m√£ ƒë∆∞·ª£c.', correct: true}, {text: 'Private Key c·ªßa Alice.', correct: false}, {text: 'Public Key c·ªßa Alice.', correct: false}, {text: 'Private Key c·ªßa Bob.', correct: false}, {text: 'Kh√≥a phi√™n.', correct: false}, {text: 'Kh√≥a CA.', correct: false}], explanation: 'Nguy√™n t·∫Øc: M√£ h√≥a b·∫±ng Public Key ng∆∞·ªùi nh·∫≠n.' },
                { q: 'CA (Certificate Authority) l√† ai?', options: [{text: 'T·ªï ch·ª©c tin c·∫≠y b√™n th·ª© ba, chuy√™n c·∫•p ph√°t v√† x√°c th·ª±c Ch·ª©ng ch·ªâ s·ªë.', correct: true}, {text: 'V√≠ d·ª•: DigiCert, Let\'s Encrypt, GlobalSign.', correct: true}, {text: 'Ng∆∞·ªùi qu·∫£n tr·ªã m·∫°ng.', correct: false}, {text: 'Nh√† cung c·∫•p m·∫°ng (ISP).', correct: false}, {text: 'Ch√≠nh ph·ªß.', correct: false}, {text: 'Hacker.', correct: false}, {text: 'M√°y ch·ªß DNS.', correct: false}], explanation: 'ƒê√≥ng vai tr√≤ trung gian tin c·∫≠y trong PKI.' },
                { q: 'Digital Certificate (Ch·ª©ng ch·ªâ s·ªë) ch·ª©a th√¥ng tin quan tr·ªçng nh·∫•t l√† g√¨?', options: [{text: 'Public Key c·ªßa ch·ªß s·ªü h·ªØu v√† Ch·ªØ k√Ω s·ªë c·ªßa CA.', correct: true}, {text: 'N√≥ li√™n k·∫øt danh t√≠nh (domain name) v·ªõi m·ªôt Public Key c·ª• th·ªÉ.', correct: true}, {text: 'Private Key.', correct: false}, {text: 'M·∫≠t kh·∫©u admin.', correct: false}, {text: 'IP server.', correct: false}, {text: 'M√£ ngu·ªìn web.', correct: false}, {text: 'Danh s√°ch user.', correct: false}], explanation: 'Gi·ªëng nh∆∞ H·ªô chi·∫øu ƒëi·ªán t·ª≠.' },
                { q: 'Man-in-the-Middle (MitM) t·∫•n c√¥ng RSA nh∆∞ th·∫ø n√†o n·∫øu kh√¥ng c√≥ PKI?', options: [{text: 'K·∫ª t·∫•n c√¥ng thay th·∫ø Public Key c·ªßa ng∆∞·ªùi nh·∫≠n b·∫±ng Public Key c·ªßa ch√≠nh h·∫Øn.', correct: true}, {text: 'Ng∆∞·ªùi g·ª≠i s·∫Ω m√£ h√≥a tin nh·∫Øn b·∫±ng kh√≥a c·ªßa k·∫ª t·∫•n c√¥ng m√† kh√¥ng hay bi·∫øt.', correct: true}, {text: 'K·∫ª t·∫•n c√¥ng ƒëo√°n Private Key.', correct: false}, {text: 'K·∫ª t·∫•n c√¥ng t·∫Øt m·∫°ng.', correct: false}, {text: 'K·∫ª t·∫•n c√¥ng s·ª≠a tin nh·∫Øn.', correct: false}, {text: 'K·∫ª t·∫•n c√¥ng d√πng DDOS.', correct: false}, {text: 'K·∫ª t·∫•n c√¥ng d√πng SQLi.', correct: false}], explanation: 'PKI ngƒÉn ch·∫∑n ƒëi·ªÅu n√†y b·∫±ng c√°ch x√°c th·ª±c ngu·ªìn g·ªëc Public Key.' },
                { q: 'H√†m phi Euler phi(n) c·ªßa n = p * q l√† g√¨?', options: [{text: '(p-1)(q-1).', correct: true}, {text: 'S·ªë l∆∞·ª£ng c√°c s·ªë nguy√™n d∆∞∆°ng nh·ªè h∆°n n v√† nguy√™n t·ªë c√πng nhau v·ªõi n.', correct: true}, {text: 'p+q.', correct: false}, {text: 'p * q.', correct: false}, {text: '(p+1)(q+1).', correct: false}, {text: 'n-1.', correct: false}, {text: 'p-q.', correct: false}], explanation: 'C√¥ng th·ª©c c·ªët l√µi ƒë·ªÉ t√≠nh kh√≥a d.' },
                { q: 'K√≠ch th∆∞·ªõc kh√≥a RSA an to√†n hi·ªán nay l√† bao nhi√™u?', options: [{text: 'T·ªëi thi·ªÉu 2048 bits (t·ªët nh·∫•t l√† 3072 ho·∫∑c 4096 bits).', correct: true}, {text: 'RSA-1024 ƒë√£ kh√¥ng c√≤n an to√†n.', correct: true}, {text: '512 bits.', correct: false}, {text: '128 bits.', correct: false}, {text: '256 bits.', correct: false}, {text: '64 bits.', correct: false}, {text: '10000 bits.', correct: false}], explanation: 'Kh√≥a RSA ph·∫£i d√†i h∆°n nhi·ªÅu so v·ªõi AES (128/256 bit) ƒë·ªÉ ƒë·∫°t c√πng ƒë·ªô b·∫£o m·∫≠t.' },
                { q: 'Hybrid Encryption (M√£ h√≥a lai) k·∫øt h·ª£p RSA v√† AES nh∆∞ th·∫ø n√†o?', options: [{text: 'D√πng RSA ƒë·ªÉ m√£ h√≥a kh√≥a phi√™n (AES Key), sau ƒë√≥ d√πng kh√≥a phi√™n ƒë·ªÉ m√£ h√≥a d·ªØ li·ªáu l·ªõn b·∫±ng AES.', correct: true}, {text: 'T·∫≠n d·ª•ng t·ªëc ƒë·ªô c·ªßa AES v√† kh·∫£ nƒÉng trao ƒë·ªïi kh√≥a c·ªßa RSA.', correct: true}, {text: 'D√πng RSA m√£ h√≥a to√†n b·ªô d·ªØ li·ªáu.', correct: false}, {text: 'D√πng AES m√£ h√≥a kh√≥a RSA.', correct: false}, {text: 'D√πng song song c·∫£ hai.', correct: false}, {text: 'RSA thay th·∫ø AES.', correct: false}, {text: 'Kh√¥ng k·∫øt h·ª£p ƒë∆∞·ª£c.', correct: false}], explanation: 'RSA r·∫•t ch·∫≠m, kh√¥ng d√πng ƒë·ªÉ m√£ h√≥a file l·ªõn.' },
                { q: 'CRL (Certificate Revocation List) l√† g√¨?', options: [{text: 'Danh s√°ch c√°c ch·ª©ng ch·ªâ s·ªë ƒë√£ b·ªã thu h·ªìi (do l·ªô kh√≥a, h·∫øt h·∫°n...) tr∆∞·ªõc th·ªùi h·∫°n.', correct: true}, {text: 'Tr√¨nh duy·ªát c·∫ßn ki·ªÉm tra danh s√°ch n√†y ƒë·ªÉ kh√¥ng tin t∆∞·ªüng ch·ª©ng ch·ªâ h·ªèng.', correct: true}, {text: 'Danh s√°ch ng∆∞·ªùi d√πng.', correct: false}, {text: 'Danh s√°ch m·∫≠t kh·∫©u.', correct: false}, {text: 'Danh s√°ch IP ch·∫∑n.', correct: false}, {text: 'Danh s√°ch CA.', correct: false}, {text: 'Danh s√°ch website.', correct: false}], explanation: 'Ho·∫∑c d√πng giao th·ª©c OCSP.' },
                { q: 'Root CA certificate th∆∞·ªùng ƒë∆∞·ª£c l∆∞u ·ªü ƒë√¢u?', options: [{text: 'ƒê∆∞·ª£c c√†i ƒë·∫∑t s·∫µn trong tr√¨nh duy·ªát ho·∫∑c h·ªá ƒëi·ªÅu h√†nh (Trust Store).', correct: true}, {text: 'L√† m·ªè neo c·ªßa ni·ªÅm tin (Trust Anchor).', correct: true}, {text: 'T·∫£i v·ªÅ m·ªói khi v√†o web.', correct: false}, {text: 'L∆∞u tr√™n server.', correct: false}, {text: 'L∆∞u trong USB.', correct: false}, {text: 'L∆∞u trong RAM.', correct: false}, {text: 'Kh√¥ng l∆∞u tr·ªØ.', correct: false}], explanation: 'N·∫øu Root CA b·ªã hack, to√†n b·ªô h·ªá th·ªëng PKI s·ª•p ƒë·ªï.' },
                { q: 'Padding trong RSA (nh∆∞ OAEP) c√≥ t√°c d·ª•ng g√¨?', options: [{text: 'L√†m ng·∫´u nhi√™n h√≥a b·∫£n r√µ tr∆∞·ªõc khi m√£ h√≥a, ch·ªëng l·∫°i c√°c t·∫•n c√¥ng b·∫£n r√µ l·ª±a ch·ªçn.', correct: true}, {text: 'ƒê·∫£m b·∫£o c√πng m·ªôt tin nh·∫Øn m√£ h√≥a 2 l·∫ßn s·∫Ω ra 2 b·∫£n m√£ kh√°c nhau.', correct: true}, {text: 'L√†m tin nh·∫Øn d√†i ra.', correct: false}, {text: 'L√†m ƒë·∫πp tin nh·∫Øn.', correct: false}, {text: 'N√©n tin nh·∫Øn.', correct: false}, {text: 'M√£ h√≥a kh√≥a.', correct: false}, {text: 'S·ª≠a l·ªói.', correct: false}], explanation: 'Textbook RSA (kh√¥ng padding) l√† kh√¥ng an to√†n.' },
                { q: 'T·∫•n c√¥ng Factorization (Ph√¢n t√≠ch th·ª´a s·ªë) nh·∫Øm v√†o ƒë√¢u?', options: [{text: 'C·ªë g·∫Øng t√¨m p v√† q t·ª´ n.', correct: true}, {text: 'N·∫øu t√¨m ƒë∆∞·ª£c p, q, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ t√≠nh ƒë∆∞·ª£c phi(n) v√† suy ra kh√≥a b√≠ m·∫≠t d.', correct: true}, {text: 'ƒêo√°n kh√≥a d tr·ª±c ti·∫øp.', correct: false}, {text: 'ƒêo√°n kh√≥a e.', correct: false}, {text: 'T·∫•n c√¥ng ƒë∆∞·ªùng truy·ªÅn.', correct: false}, {text: 'T·∫•n c√¥ng CA.', correct: false}, {text: 'T·∫•n c√¥ng tr√¨nh duy·ªát.', correct: false}], explanation: 'B√†i to√°n kh√≥ nh·∫•t c·ªßa RSA.' },
                { q: 'Self-signed Certificate (Ch·ª©ng ch·ªâ t·ª± k√Ω) c√≥ an to√†n kh√¥ng?', options: [{text: 'V·ªÅ m·∫∑t m√£ h√≥a th√¨ c√≥, nh∆∞ng v·ªÅ m·∫∑t x√°c th·ª±c danh t√≠nh th√¨ KH√îNG (v√¨ kh√¥ng ai b·∫£o l√£nh).', correct: true}, {text: 'Tr√¨nh duy·ªát s·∫Ω c·∫£nh b√°o "Not Secure".', correct: true}, {text: 'R·∫•t an to√†n.', correct: false}, {text: 'Kh√¥ng d√πng ƒë∆∞·ª£c.', correct: false}, {text: 'An to√†n h∆°n CA.', correct: false}, {text: 'Ch·ªâ d√πng cho hacker.', correct: false}, {text: 'T·ªën ti·ªÅn mua.', correct: false}], explanation: 'Ch·ªâ d√πng cho m√¥i tr∆∞·ªùng Dev/Test.' },
                { q: 'Ph√©p to√°n ch√≠nh trong RSA l√† g√¨?', options: [{text: 'L≈©y th·ª´a modulo (Modular Exponentiation).', correct: true}, {text: 'C = M^e mod n.', correct: true}, {text: 'XOR.', correct: false}, {text: 'D·ªãch bit.', correct: false}, {text: 'Nh√¢n ma tr·∫≠n.', correct: false}, {text: 'Thay th·∫ø S-box.', correct: false}, {text: 'H√†m bƒÉm.', correct: false}], explanation: 'T√≠nh to√°n t·ªën k√©m t√†i nguy√™n.' },
                { q: 'X.509 l√† g√¨?', options: [{text: 'Ti√™u chu·∫©n qu·ªëc t·∫ø ƒë·ªãnh d·∫°ng cho Ch·ª©ng ch·ªâ s·ªë (Digital Certificate).', correct: true}, {text: 'Quy ƒë·ªãnh c·∫•u tr√∫c file .crt, .pem, .cer...', correct: true}, {text: 'T√™n m·ªôt thu·∫≠t to√°n.', correct: false}, {text: 'T√™n m·ªôt virus.', correct: false}, {text: 'Chu·∫©n wifi.', correct: false}, {text: 'Chu·∫©n ·ªï c·ª©ng.', correct: false}, {text: 'M√£ h√≥a ƒë·ªëi x·ª©ng.', correct: false}], explanation: 'Chu·∫©n ph·ªï bi·∫øn nh·∫•t trong PKI.' },
                { q: 'Trong RSA, e th∆∞·ªùng ƒë∆∞·ª£c ch·ªçn l√† 65537 v√¨ sao?', options: [{text: 'N√≥ l√† s·ªë nguy√™n t·ªë Fermat, gi√∫p t√≠nh to√°n m√£ h√≥a nhanh (ch·ªâ c·∫ßn 17 ph√©p nh√¢n).', correct: true}, {text: 'C√¢n b·∫±ng gi·ªØa hi·ªáu su·∫•t v√† an to√†n.', correct: true}, {text: 'V√¨ n√≥ ng·∫´u nhi√™n.', correct: false}, {text: 'V√¨ n√≥ l·ªõn nh·∫•t.', correct: false}, {text: 'V√¨ n√≥ nh·ªè nh·∫•t.', correct: false}, {text: 'V√¨ n√≥ b√≠ m·∫≠t.', correct: false}, {text: 'Kh√¥ng c√≥ l√Ω do.', correct: false}], explanation: 'Binary l√† 10000000000000001.' }
            ],

            // TOPIC 20: DIFFIE-HELLMAN & HTTPS (20 Questions)
            'topic-20': [
                { q: 'M·ª•c ƒë√≠ch c·ªßa giao th·ª©c Diffie-Hellman (DH)?', options: [{text: 'Trao ƒë·ªïi kh√≥a b√≠ m·∫≠t chung qua k√™nh kh√¥ng an to√†n.', correct: true}, {text: 'Hai b√™n th·ªëng nh·∫•t m·ªôt Shared Secret m√† ng∆∞·ªùi nghe l√©n kh√¥ng bi·∫øt.', correct: true}, {text: 'M√£ h√≥a tin nh·∫Øn.', correct: false}, {text: 'K√Ω s·ªë.', correct: false}, {text: 'X√°c th·ª±c danh t√≠nh.', correct: false}, {text: 'N√©n d·ªØ li·ªáu.', correct: false}, {text: 'BƒÉm m·∫≠t kh·∫©u.', correct: false}], explanation: 'Key Exchange Protocol.' },
                { q: 'B√†i to√°n kh√≥ l√†m n·ªÅn t·∫£ng cho DH l√† g√¨?', options: [{text: 'Logarit R·ªùi r·∫°c (Discrete Logarithm Problem).', correct: true}, {text: 'Bi·∫øt g, p, g^a, r·∫•t kh√≥ t√¨m a.', correct: true}, {text: 'Ph√¢n t√≠ch th·ª´a s·ªë nguy√™n t·ªë.', correct: false}, {text: 'Ba l√¥.', correct: false}, {text: 'ƒê∆∞·ªùng cong.', correct: false}, {text: 'H√†m bƒÉm.', correct: false}, {text: 'L≈©y th·ª´a.', correct: false}], explanation: 'Ng∆∞·ª£c l·∫°i v·ªõi ph√©p l≈©y th·ª´a modulo (d·ªÖ).' },
                { q: 'Trong DH, gi√° tr·ªã n√†o l√† B√ç M·∫¨T?', options: [{text: 'S·ªë m≈© c√° nh√¢n (Private exponent) a v√† b.', correct: true}, {text: 'Alice gi·ªØ a, Bob gi·ªØ b.', correct: true}, {text: 'S·ªë nguy√™n t·ªë p.', correct: false}, {text: 'C∆° s·ªë g.', correct: false}, {text: 'Gi√° tr·ªã trao ƒë·ªïi A (g^a).', correct: false}, {text: 'Gi√° tr·ªã trao ƒë·ªïi B (g^b).', correct: false}, {text: 'Kh√≥a chung.', correct: false}], explanation: 'p, g, A, B ƒë·ªÅu c√¥ng khai tr√™n ƒë∆∞·ªùng truy·ªÅn.' },
                { q: 'T·∫•n c√¥ng Man-in-the-Middle (MitM) v√†o DH x·∫£y ra th·∫ø n√†o?', options: [{text: 'Eve ƒë·ª©ng gi·ªØa, thi·∫øt l·∫≠p kh√≥a ri√™ng v·ªõi Alice v√† kh√≥a ri√™ng v·ªõi Bob.', correct: true}, {text: 'Alice nghƒ© m√¨nh ƒëang n√≥i chuy·ªán v·ªõi Bob, nh∆∞ng th·ª±c ra l√† v·ªõi Eve.', correct: true}, {text: 'Eve gi·∫£i m√£ ƒë∆∞·ª£c logarit.', correct: false}, {text: 'Eve ƒëo√°n ƒë∆∞·ª£c a v√† b.', correct: false}, {text: 'Eve t·∫Øt m·∫°ng.', correct: false}, {text: 'Eve d√πng brute-force.', correct: false}, {text: 'Eve d√πng virus.', correct: false}], explanation: 'DH kh√¥ng c√≥ x√°c th·ª±c danh t√≠nh, n√™n c·∫ßn k·∫øt h·ª£p v·ªõi RSA/PKI ƒë·ªÉ ch·ªëng MitM.' },
                { q: 'Forward Secrecy (B·∫£o m·∫≠t chuy·ªÉn ti·∫øp) trong HTTPS ƒë·∫°t ƒë∆∞·ª£c nh·ªù g√¨?', options: [{text: 'S·ª≠ d·ª•ng Ephemeral Diffie-Hellman (DHE ho·∫∑c ECDHE).', correct: true}, {text: 'T·∫°o kh√≥a phi√™n m·ªõi cho m·ªói k·∫øt n·ªëi, kh√¥ng ph·ª• thu·ªôc v√†o Private Key l√¢u d√†i c·ªßa server.', correct: true}, {text: 'D√πng RSA.', correct: false}, {text: 'D√πng AES.', correct: false}, {text: 'D√πng HMAC.', correct: false}, {text: 'D√πng kh√≥a d√†i.', correct: false}, {text: 'D√πng Certificate.', correct: false}], explanation: 'N·∫øu Private Key server b·ªã l·ªô trong t∆∞∆°ng lai, c√°c tin nh·∫Øn qu√° kh·ª© v·∫´n an to√†n.' },
                { q: 'HTTPS l√† s·ª± k·∫øt h·ª£p c·ªßa HTTP v√† giao th·ª©c n√†o?', options: [{text: 'TLS (Transport Layer Security) ho·∫∑c SSL (c≈©).', correct: true}, {text: 'HTTP over TLS.', correct: true}, {text: 'SSH.', correct: false}, {text: 'IPSec.', correct: false}, {text: 'VPN.', correct: false}, {text: 'TCP.', correct: false}, {text: 'DNS.', correct: false}], explanation: 'B·∫£o v·ªá d·ªØ li·ªáu truy·ªÅn t·∫£i.' },
                { q: 'Giai ƒëo·∫°n n√†o trong TLS Handshake t·ªën t√†i nguy√™n nh·∫•t?', options: [{text: 'Asymmetric Encryption (RSA/DH) ƒë·ªÉ trao ƒë·ªïi kh√≥a.', correct: true}, {text: 'T√≠nh to√°n l≈©y th·ª´a s·ªë l·ªõn r·∫•t n·∫∑ng.', correct: true}, {text: 'Symmetric Encryption (AES).', correct: false}, {text: 'Hashing (HMAC).', correct: false}, {text: 'G·ª≠i d·ªØ li·ªáu.', correct: false}, {text: 'DNS lookup.', correct: false}, {text: 'TCP handshake.', correct: false}], explanation: 'Do ƒë√≥ c·∫ßn Session Resumption ƒë·ªÉ gi·∫£m t·∫£i.' },
                { q: 'ECDH (Elliptic Curve Diffie-Hellman) ∆∞u vi·ªát h∆°n DH th∆∞·ªùng ·ªü ƒëi·ªÉm n√†o?', options: [{text: 'D√πng kh√≥a ng·∫Øn h∆°n nh∆∞ng ƒë·ªô b·∫£o m·∫≠t t∆∞∆°ng ƒë∆∞∆°ng, t√≠nh to√°n nhanh h∆°n.', correct: true}, {text: 'D·ª±a tr√™n ƒë∆∞·ªùng cong Elliptic.', correct: true}, {text: 'An to√†n h∆°n tuy·ªát ƒë·ªëi.', correct: false}, {text: 'D·ªÖ c√†i ƒë·∫∑t h∆°n.', correct: false}, {text: 'Kh√¥ng b·ªã MitM.', correct: false}, {text: 'Kh√¥ng c·∫ßn s·ªë nguy√™n t·ªë.', correct: false}, {text: 'D√πng cho wifi.', correct: false}], explanation: 'Chu·∫©n hi·ªán ƒë·∫°i cho mobile/web.' },
                { q: 'Cipher Suite "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256" c√≥ nghƒ©a l√† g√¨?', options: [{text: 'Trao ƒë·ªïi kh√≥a ECDHE, X√°c th·ª±c RSA, M√£ h√≥a AES-128-GCM, Hash SHA256.', correct: true}, {text: 'M√¥ t·∫£ tr·ªçn b·ªô c√¥ng th·ª©c b·∫£o m·∫≠t cho k·∫øt n·ªëi.', correct: true}, {text: 'Ch·ªâ d√πng AES.', correct: false}, {text: 'Ch·ªâ d√πng RSA.', correct: false}, {text: 'T√™n m·ªôt lo·∫°i virus.', correct: false}, {text: 'C·∫•u h√¨nh server.', correct: false}, {text: 'M·∫≠t kh·∫©u wifi.', correct: false}], explanation: 'C·∫•u tr√∫c: Protocol_KeyExchange_Auth_Enc_Hash.' },
                { q: 'HSTS (HTTP Strict Transport Security) d√πng ƒë·ªÉ l√†m g√¨?', options: [{text: '√âp tr√¨nh duy·ªát lu√¥n truy c·∫≠p website b·∫±ng HTTPS.', correct: true}, {text: 'NgƒÉn ch·∫∑n t·∫•n c√¥ng SSL Stripping.', correct: true}, {text: 'M√£ h√≥a d·ªØ li·ªáu.', correct: false}, {text: 'Ch·∫∑n XSS.', correct: false}, {text: 'Ch·∫∑n SQLi.', correct: false}, {text: 'TƒÉng t·ªëc web.', correct: false}, {text: 'L∆∞u cookie.', correct: false}], explanation: 'Header: Strict-Transport-Security.' },
                { q: 'Ch·ª©ng ch·ªâ s·ªë EV (Extended Validation) kh√°c g√¨ DV (Domain Validated)?', options: [{text: 'Quy tr√¨nh x√°c minh danh t√≠nh t·ªï ch·ª©c nghi√™m ng·∫∑t h∆°n (hi·ªán thanh ƒë·ªãa ch·ªâ m√†u xanh l√° c√¢y ·ªü tr√¨nh duy·ªát c≈©).', correct: true}, {text: 'V·ªÅ m·∫∑t m√£ h√≥a th√¨ nh∆∞ nhau.', correct: true}, {text: 'M√£ h√≥a m·∫°nh h∆°n.', correct: false}, {text: 'T·ªëc ƒë·ªô nhanh h∆°n.', correct: false}, {text: 'R·∫ª h∆°n.', correct: false}, {text: 'Kh√¥ng c·∫ßn x√°c minh.', correct: false}, {text: 'D√πng cho c√° nh√¢n.', correct: false}], explanation: 'TƒÉng ƒë·ªô tin c·∫≠y th∆∞∆°ng hi·ªáu.' },
                { q: 'SNI (Server Name Indication) gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ g√¨?', options: [{text: 'Cho ph√©p nhi·ªÅu ch·ª©ng ch·ªâ SSL (nhi·ªÅu domain) ch·∫°y tr√™n c√πng m·ªôt ƒë·ªãa ch·ªâ IP.', correct: true}, {text: 'Client g·ª≠i t√™n mi·ªÅn mu·ªën truy c·∫≠p ngay trong Client Hello.', correct: true}, {text: 'TƒÉng t·ªëc HTTPS.', correct: false}, {text: 'M√£ h√≥a IP.', correct: false}, {text: '·∫®n danh t√≠nh.', correct: false}, {text: 'Ch·∫∑n qu·∫£ng c√°o.', correct: false}, {text: 'D√πng IPv6.', correct: false}], explanation: 'C·∫ßn thi·∫øt cho Virtual Hosting.' },
                { q: 'T·∫°i sao SSL v3 v√† TLS 1.0/1.1 b·ªã khai t·ª≠?', options: [{text: 'Ch·ª©a nhi·ªÅu l·ªó h·ªïng nghi√™m tr·ªçng (POODLE, BEAST...).', correct: true}, {text: 'Kh√¥ng h·ªó tr·ª£ c√°c thu·∫≠t to√°n m√£ h√≥a hi·ªán ƒë·∫°i (AEAD).', correct: true}, {text: 'Ch·∫°y ch·∫≠m.', correct: false}, {text: 'H·∫øt h·∫°n b·∫£n quy·ªÅn.', correct: false}, {text: 'Kh√¥ng ai d√πng.', correct: false}, {text: 'Do Google gh√©t.', correct: false}, {text: 'Do t·ªën ƒëi·ªán.', correct: false}], explanation: 'Hi·ªán t·∫°i d√πng TLS 1.2 v√† 1.3.' },
                { q: 'Session Key (Kh√≥a phi√™n) ƒë∆∞·ª£c t·∫°o ra khi n√†o?', options: [{text: 'Sau khi ho√†n t·∫•t Handshake v√† trao ƒë·ªïi Pre-master Secret.', correct: true}, {text: 'ƒê∆∞·ª£c d√πng ƒë·ªÉ m√£ h√≥a d·ªØ li·ªáu ch√≠nh (AES) v√¨ t·ªëc ƒë·ªô nhanh.', correct: true}, {text: 'Tr∆∞·ªõc khi k·∫øt n·ªëi.', correct: false}, {text: 'ƒê∆∞·ª£c c·∫•p b·ªüi CA.', correct: false}, {text: 'L∆∞u trong DB.', correct: false}, {text: 'Ng∆∞·ªùi d√πng t·ª± nh·∫≠p.', correct: false}, {text: 'Kh√¥ng bao gi·ªù t·∫°o.', correct: false}], explanation: 'M·ªói phi√™n d√πng m·ªôt kh√≥a ƒë·ªëi x·ª©ng ri√™ng.' },
                { q: 'Downgrade Attack (T·∫•n c√¥ng h·∫° c·∫•p) trong TLS l√† g√¨?', options: [{text: 'K·∫ª t·∫•n c√¥ng √©p client v√† server s·ª≠ d·ª•ng phi√™n b·∫£n giao th·ª©c c≈©/y·∫øu h∆°n (nh∆∞ SSL 3.0) ƒë·ªÉ khai th√°c l·ªó h·ªïng.', correct: true}, {text: 'V√≠ d·ª•: POODLE attack.', correct: true}, {text: 'H·∫° c·∫•p server.', correct: false}, {text: 'H·∫° c·∫•p m·∫°ng.', correct: false}, {text: 'D√πng HTTP.', correct: false}, {text: 'T·∫Øt m√£ h√≥a.', correct: false}, {text: 'X√≥a ch·ª©ng ch·ªâ.', correct: false}], explanation: 'TLS_FALLBACK_SCSV ngƒÉn ch·∫∑n ƒëi·ªÅu n√†y.' },
                { q: 'OCSP Stapling l√† g√¨?', options: [{text: 'Server t·ª± l·∫•y tr·∫°ng th√°i thu h·ªìi ch·ª©ng ch·ªâ t·ª´ CA v√† g·ª≠i k√®m cho Client.', correct: true}, {text: 'Gi√∫p Client kh√¥ng ph·∫£i t·ª± h·ªèi CA, tƒÉng t·ªëc ƒë·ªô v√† b·∫£o m·∫≠t quy·ªÅn ri√™ng t∆∞.', correct: true}, {text: 'Ghim ch·ª©ng ch·ªâ.', correct: false}, {text: 'K·∫πp gi·∫•y.', correct: false}, {text: 'X√°c th·ª±c 2 b∆∞·ªõc.', correct: false}, {text: 'L∆∞u cache.', correct: false}, {text: 'M√£ h√≥a file.', correct: false}], explanation: 'T·ªëi ∆∞u h√≥a hi·ªáu nƒÉng HTTPS.' },
                { q: 'TLS 1.3 c√≥ c·∫£i ti·∫øn g√¨ l·ªõn so v·ªõi 1.2?', options: [{text: 'Handshake nhanh h∆°n (1-RTT), b·ªè c√°c thu·∫≠t to√°n y·∫øu, b·∫Øt bu·ªôc Forward Secrecy.', correct: true}, {text: 'B·∫£o m·∫≠t v√† hi·ªáu nƒÉng t·ªët h∆°n.', correct: true}, {text: 'Ch·∫≠m h∆°n.', correct: false}, {text: 'D√πng kh√≥a ng·∫Øn h∆°n.', correct: false}, {text: 'H·ªó tr·ª£ SSL c≈©.', correct: false}, {text: 'Kh√¥ng d√πng DH.', correct: false}, {text: 'Kh√¥ng m√£ h√≥a.', correct: false}], explanation: 'Chu·∫©n m·ªõi nh·∫•t.' },
                { q: 'Pre-master Secret l√† g√¨?', options: [{text: 'Gi√° tr·ªã b√≠ m·∫≠t trung gian ƒë∆∞·ª£c th·ªëng nh·∫•t qua DH ho·∫∑c RSA, d√πng ƒë·ªÉ sinh ra Session Key.', correct: true}, {text: 'L√† "nguy√™n li·ªáu" ch√≠nh ƒë·ªÉ t·∫°o kh√≥a.', correct: true}, {text: 'L√† Session Key.', correct: false}, {text: 'L√† Private Key.', correct: false}, {text: 'L√† Public Key.', correct: false}, {text: 'L√† Password.', correct: false}, {text: 'L√† Salt.', correct: false}], explanation: 'ƒê·∫£m b·∫£o c·∫£ 2 b√™n c√≥ c√πng b√≠ m·∫≠t.' },
                { q: 'Heartbleed l√† l·ªó h·ªïng c·ªßa th∆∞ vi·ªán n√†o?', options: [{text: 'OpenSSL.', correct: true}, {text: 'L·ªói ƒë·ªçc b·ªô nh·ªõ ƒë·ªám (Buffer Over-read) cho ph√©p r√≤ r·ªâ d·ªØ li·ªáu nh·∫°y c·∫£m (kh√≥a, pass) t·ª´ server.', correct: true}, {text: 'Java.', correct: false}, {text: 'Windows.', correct: false}, {text: 'Chrome.', correct: false}, {text: 'Apache.', correct: false}, {text: 'Python.', correct: false}], explanation: 'Th·∫£m h·ªça b·∫£o m·∫≠t nƒÉm 2014.' },
                { q: 'Let\'s Encrypt cung c·∫•p c√°i g√¨?', options: [{text: 'Ch·ª©ng ch·ªâ SSL/TLS mi·ªÖn ph√≠ v√† t·ª± ƒë·ªông h√≥a.', correct: true}, {text: 'Gi√∫p ph·ªï c·∫≠p HTTPS to√†n c·∫ßu.', correct: true}, {text: 'Hosting mi·ªÖn ph√≠.', correct: false}, {text: 'T√™n mi·ªÅn mi·ªÖn ph√≠.', correct: false}, {text: 'M√£ h√≥a file.', correct: false}, {text: 'VPN mi·ªÖn ph√≠.', correct: false}, {text: 'Email b·∫£o m·∫≠t.', correct: false}], explanation: 'Domain Validation (DV) certificates.' }
            ],

            // TOPIC 21: JWT (20 Questions)
            'topic-21': [
                { q: 'JWT (JSON Web Token) th∆∞·ªùng ƒë∆∞·ª£c d√πng ƒë·ªÉ l√†m g√¨?', options: [{text: 'X√°c th·ª±c (Authentication) v√† Trao ƒë·ªïi th√¥ng tin an to√†n.', correct: true}, {text: 'Ph·ªï bi·∫øn trong c√°c ·ª©ng d·ª•ng Single Page App (SPA) v√† API.', correct: true}, {text: 'M√£ h√≥a m·∫≠t kh·∫©u.', correct: false}, {text: 'L∆∞u tr·ªØ database.', correct: false}, {text: 'G·ª≠i email.', correct: false}, {text: 'N√©n ·∫£nh.', correct: false}, {text: 'Qu√©t virus.', correct: false}], explanation: 'Token-based Authentication.' },
                { q: 'JWT g·ªìm 3 ph·∫ßn n√†o?', options: [{text: 'Header, Payload, Signature.', correct: true}, {text: 'C√°ch nhau b·ªüi d·∫•u ch·∫•m (.).', correct: true}, {text: 'User, Pass, Email.', correct: false}, {text: 'Id, Name, Role.', correct: false}, {text: 'Start, Middle, End.', correct: false}, {text: 'Key, Value, Sign.', correct: false}, {text: 'Encrypted, Plain, Hash.', correct: false}], explanation: 'C·∫•u tr√∫c chu·∫©n.' },
                { q: 'D·ªØ li·ªáu trong Payload c·ªßa JWT c√≥ ƒë∆∞·ª£c m√£ h√≥a kh√¥ng?', options: [{text: 'Kh√¥ng, n√≥ ch·ªâ ƒë∆∞·ª£c Encode Base64Url.', correct: true}, {text: 'B·∫•t k·ª≥ ai c√≥ token ƒë·ªÅu c√≥ th·ªÉ gi·∫£i m√£ (decode) ƒë·ªÉ ƒë·ªçc n·ªôi dung.', correct: true}, {text: 'C√≥, ƒë∆∞·ª£c m√£ h√≥a AES.', correct: false}, {text: 'C√≥, ƒë∆∞·ª£c m√£ h√≥a RSA.', correct: false}, {text: 'Ch·ªâ server ƒë·ªçc ƒë∆∞·ª£c.', correct: false}, {text: 'ƒê∆∞·ª£c bƒÉm MD5.', correct: false}, {text: '·∫®n ƒëi.', correct: false}], explanation: 'Kh√¥ng bao gi·ªù ƒë·ªÉ th√¥ng tin m·∫≠t (pass, th·∫ª) trong JWT.' },
                { q: 'Signature trong JWT d√πng ƒë·ªÉ l√†m g√¨?', options: [{text: 'ƒê·∫£m b·∫£o t√≠nh to√†n v·∫πn (Integrity) c·ªßa token.', correct: true}, {text: 'Gi√∫p server nh·∫≠n bi·∫øt n·∫øu token b·ªã s·ª≠a ƒë·ªïi.', correct: true}, {text: 'M√£ h√≥a payload.', correct: false}, {text: '·∫®n th√¥ng tin.', correct: false}, {text: 'N√©n token.', correct: false}, {text: 'T·∫°o user.', correct: false}, {text: 'G·ª≠i email.', correct: false}], explanation: 'Server k√Ω b·∫±ng kh√≥a b√≠ m·∫≠t, ch·ªâ server m·ªõi verify ƒë∆∞·ª£c (v·ªõi HMAC).' },
                { q: 'Thu·∫≠t to√°n "HS256" trong Header nghƒ©a l√† g√¨?', options: [{text: 'HMAC v·ªõi SHA-256.', correct: true}, {text: 'S·ª≠ d·ª•ng kh√≥a ƒë·ªëi x·ª©ng (Shared Secret).', correct: true}, {text: 'RSA v·ªõi SHA-256.', correct: false}, {text: 'Hashing 256 l·∫ßn.', correct: false}, {text: 'High Security 256.', correct: false}, {text: 'Hybrid System.', correct: false}, {text: 'Kh√¥ng c√≥ thu·∫≠t to√°n.', correct: false}], explanation: 'Ph·ªï bi·∫øn nh·∫•t.' },
                { q: 'Thu·∫≠t to√°n "RS256" d√πng lo·∫°i kh√≥a n√†o?', options: [{text: 'Kh√≥a b·∫•t ƒë·ªëi x·ª©ng (Private Key ƒë·ªÉ k√Ω, Public Key ƒë·ªÉ x√°c th·ª±c).', correct: true}, {text: 'D√πng khi Server Auth v√† Resource Server l√† 2 h·ªá th·ªëng kh√°c nhau.', correct: true}, {text: 'Kh√≥a ƒë·ªëi x·ª©ng.', correct: false}, {text: 'Kh√¥ng d√πng kh√≥a.', correct: false}, {text: 'D√πng m·∫≠t kh·∫©u user.', correct: false}, {text: 'D√πng v√¢n tay.', correct: false}, {text: 'D√πng OTP.', correct: false}], explanation: 'RSA Signature.' },
                { q: 'L·ªó h·ªïng "None Algorithm" trong JWT l√† g√¨?', options: [{text: 'Hacker s·ª≠a header th√†nh {"alg": "none"} v√† b·ªè qua ch·ªØ k√Ω.', correct: true}, {text: 'M·ªôt s·ªë th∆∞ vi·ªán c≈© ch·∫•p nh·∫≠n token kh√¥ng c√≥ ch·ªØ k√Ω l√† h·ª£p l·ªá -> Bypass Auth.', correct: true}, {text: 'Kh√¥ng c√≥ thu·∫≠t to√°n n√†o an to√†n.', correct: false}, {text: 'Token kh√¥ng c√≥ payload.', correct: false}, {text: 'Token b·ªã r·ªóng.', correct: false}, {text: 'L·ªói server.', correct: false}, {text: 'L·ªói m·∫°ng.', correct: false}], explanation: 'C·∫ßn ch·∫∑n alg: none.' },
                { q: 'T·∫°i sao kh√¥ng n√™n l∆∞u JWT trong LocalStorage?', options: [{text: 'D·ªÖ b·ªã t·∫•n c√¥ng XSS ƒë√°nh c·∫Øp.', correct: true}, {text: 'JS ƒë·ªôc h·∫°i c√≥ th·ªÉ ƒë·ªçc LocalStorage v√† g·ª≠i token v·ªÅ cho hacker.', correct: true}, {text: 'LocalStorage kh√¥ng ƒë·ªß ch·ªó.', correct: false}, {text: 'LocalStorage ch·∫≠m.', correct: false}, {text: 'LocalStorage t·ª± x√≥a.', correct: false}, {text: 'Kh√¥ng h·ªó tr·ª£ mobile.', correct: false}, {text: 'Server kh√¥ng ƒë·ªçc ƒë∆∞·ª£c.', correct: false}], explanation: 'N√™n l∆∞u trong HttpOnly Cookie.' },
                { q: 'Stateless Authentication (X√°c th·ª±c phi tr·∫°ng th√°i) nghƒ©a l√† g√¨?', options: [{text: 'Server kh√¥ng c·∫ßn l∆∞u tr·∫°ng th√°i phi√™n (Session) c·ªßa ng∆∞·ªùi d√πng.', correct: true}, {text: 'M·ªçi th√¥ng tin c·∫ßn thi·∫øt ƒë√£ n·∫±m trong Token.', correct: true}, {text: 'Kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p.', correct: false}, {text: 'Kh√¥ng c√≥ b·∫£o m·∫≠t.', correct: false}, {text: 'Kh√¥ng d√πng m·∫°ng.', correct: false}, {text: 'User kh√¥ng c√≥ t√™n.', correct: false}, {text: 'Server kh√¥ng c√≥ DB.', correct: false}], explanation: 'D·ªÖ d√†ng m·ªü r·ªông (Scale) server.' },
                { q: 'Claim "exp" trong Payload l√† g√¨?', options: [{text: 'Expiration Time (Th·ªùi gian h·∫øt h·∫°n).', correct: true}, {text: 'Token s·∫Ω kh√¥ng ƒë∆∞·ª£c ch·∫•p nh·∫≠n sau th·ªùi gian n√†y.', correct: true}, {text: 'Experience.', correct: false}, {text: 'Exception.', correct: false}, {text: 'Expert.', correct: false}, {text: 'Export.', correct: false}, {text: 'Example.', correct: false}], explanation: 'JWT c·∫ßn c√≥ h·∫°n s·ª≠ d·ª•ng ng·∫Øn.' },
                { q: 'L√†m sao ƒë·ªÉ thu h·ªìi (Revoke) m·ªôt JWT tr∆∞·ªõc khi n√≥ h·∫øt h·∫°n?', options: [{text: 'Kh√≥ khƒÉn (do t√≠nh ch·∫•t stateless). Ph·∫£i d√πng Blacklist ho·∫∑c gi·∫£m th·ªùi gian h·∫øt h·∫°n.', correct: true}, {text: 'Kh√¥ng th·ªÉ x√≥a token kh·ªèi m√°y client.', correct: true}, {text: 'X√≥a kh·ªèi LocalStorage.', correct: false}, {text: 'ƒê·ªïi m·∫≠t kh·∫©u.', correct: false}, {text: 'T·∫Øt server.', correct: false}, {text: 'X√≥a DB.', correct: false}, {text: 'D·ªÖ d√†ng x√≥a.', correct: false}], explanation: 'Nh∆∞·ª£c ƒëi·ªÉm l·ªõn nh·∫•t c·ªßa JWT.' },
                { q: 'T·∫•n c√¥ng Brute-force kh√≥a b√≠ m·∫≠t JWT di·ªÖn ra khi n√†o?', options: [{text: 'Khi Server s·ª≠ d·ª•ng kh√≥a b√≠ m·∫≠t y·∫øu (v√≠ d·ª•: "secret123") cho HMAC.', correct: true}, {text: 'Hacker c√≥ th·ªÉ crack ch·ªØ k√Ω offline ƒë·ªÉ t√¨m ra kh√≥a v√† t·ª± t·∫°o token admin.', correct: true}, {text: 'Khi d√πng RSA.', correct: false}, {text: 'Khi d√πng HTTPS.', correct: false}, {text: 'Khi token qu√° d√†i.', correct: false}, {text: 'Khi token h·∫øt h·∫°n.', correct: false}, {text: 'Khi server m·∫°nh.', correct: false}], explanation: 'C·∫ßn d√πng kh√≥a d√†i, ng·∫´u nhi√™n.' },
                { q: 'Refresh Token d√πng ƒë·ªÉ l√†m g√¨?', options: [{text: 'L·∫•y Access Token m·ªõi khi token c≈© h·∫øt h·∫°n m√† kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p l·∫°i.', correct: true}, {text: 'Refresh Token th∆∞·ªùng c√≥ h·∫°n d√†i h∆°n v√† ƒë∆∞·ª£c l∆∞u b·∫£o m·∫≠t h∆°n.', correct: true}, {text: 'L√†m m·ªõi trang web.', correct: false}, {text: 'X√≥a cache.', correct: false}, {text: 'ƒê·ªïi m·∫≠t kh·∫©u.', correct: false}, {text: 'TƒÉng t·ªëc m·∫°ng.', correct: false}, {text: 'Thay ƒë·ªïi giao di·ªán.', correct: false}], explanation: 'M√¥ h√¨nh Access/Refresh Token.' },
                { q: 'KID (Key ID) trong Header d√πng ƒë·ªÉ l√†m g√¨?', options: [{text: 'Ch·ªâ ƒë·ªãnh kh√≥a n√†o (trong nhi·ªÅu kh√≥a) ƒë∆∞·ª£c d√πng ƒë·ªÉ k√Ω token.', correct: true}, {text: 'H·ªØu √≠ch khi server xoay v√≤ng kh√≥a (Key Rotation).', correct: true}, {text: 'ID c·ªßa ng∆∞·ªùi d√πng.', correct: false}, {text: 'ID c·ªßa token.', correct: false}, {text: 'ID c·ªßa session.', correct: false}, {text: 'ID c·ªßa app.', correct: false}, {text: 'ID c·ªßa admin.', correct: false}], explanation: 'C√≥ th·ªÉ b·ªã khai th√°c (Directory Traversal/SQLi trong KID).' },
                { q: 'Base64Url kh√°c Base64 th∆∞·ªùng ch·ªó n√†o?', options: [{text: 'Thay th·∫ø k√Ω t·ª± `+` b·∫±ng `-`, `/` b·∫±ng `_` v√† b·ªè d·∫•u `=`.', correct: true}, {text: 'ƒê·ªÉ an to√†n khi truy·ªÅn qua URL (URL-safe).', correct: true}, {text: 'Kh√°c ho√†n to√†n.', correct: false}, {text: 'M√£ h√≥a m·∫°nh h∆°n.', correct: false}, {text: 'Ng·∫Øn h∆°n.', correct: false}, {text: 'D√†i h∆°n.', correct: false}, {text: 'Kh√¥ng kh√°c g√¨.', correct: false}], explanation: 'Chu·∫©n c·ªßa JWT.' },
                { q: 'JWT c√≥ ch·ªëng ƒë∆∞·ª£c CSRF kh√¥ng?', options: [{text: 'N·∫øu l∆∞u trong LocalStorage th√¨ kh√¥ng b·ªã CSRF (nh∆∞ng b·ªã XSS). N·∫øu l∆∞u Cookie th√¨ v·∫´n b·ªã CSRF.', correct: true}, {text: 'B·∫£n th√¢n JWT kh√¥ng ph·∫£i l√† c∆° ch·∫ø ch·ªëng CSRF.', correct: true}, {text: 'C√≥, ch·ªëng ho√†n to√†n.', correct: false}, {text: 'Kh√¥ng bao gi·ªù.', correct: false}, {text: 'T√πy tr√¨nh duy·ªát.', correct: false}, {text: 'Ch·ªâ tr√™n Mobile.', correct: false}, {text: 'N·∫øu d√πng HTTPS.', correct: false}], explanation: 'N∆°i l∆∞u tr·ªØ quy·∫øt ƒë·ªãnh lo·∫°i l·ªó h·ªïng.' },
                { q: 'Claim "sub" (Subject) th∆∞·ªùng ch·ª©a g√¨?', options: [{text: 'ƒê·ªãnh danh ng∆∞·ªùi d√πng (User ID).', correct: true}, {text: 'Ch·ªß th·ªÉ c·ªßa token.', correct: true}, {text: 'Ti√™u ƒë·ªÅ.', correct: false}, {text: 'M√¥n h·ªçc.', correct: false}, {text: 'Th·ªùi gian.', correct: false}, {text: 'N∆°i ph√°t h√†nh.', correct: false}, {text: 'Kh√°n gi·∫£.', correct: false}], explanation: 'Standard Claims.' },
                { q: 'Th∆∞ vi·ªán `jsonwebtoken` trong Node.js c√≥ an to√†n m·∫∑c ƒë·ªãnh kh√¥ng?', options: [{text: 'Kh√° an to√†n, nh∆∞ng c·∫ßn c·∫•u h√¨nh ƒë√∫ng thu·∫≠t to√°n v√† kh√≥a.', correct: true}, {text: 'Developer ph·∫£i t·ª± lo vi·ªác verify.', correct: true}, {text: 'Tuy·ªát ƒë·ªëi an to√†n.', correct: false}, {text: 'R·∫•t nhi·ªÅu l·ªói.', correct: false}, {text: 'Kh√¥ng d√πng ƒë∆∞·ª£c.', correct: false}, {text: 'Ch·ªâ cho test.', correct: false}, {text: 'T·ª± ƒë·ªông h·∫øt.', correct: false}], explanation: 'Tool t·ªët c·∫ßn ng∆∞·ªùi th·ª£ gi·ªèi.' },
                { q: 'Key Confusion Attack (Algorithm Confusion) l√† g√¨?', options: [{text: 'Hacker ƒë·ªïi thu·∫≠t to√°n t·ª´ RS256 sang HS256 v√† k√Ω b·∫±ng Public Key c·ªßa server.', correct: true}, {text: 'Server b·ªã l·ª´a d√πng Public Key nh∆∞ l√† kh√≥a b√≠ m·∫≠t HMAC ƒë·ªÉ verify.', correct: true}, {text: 'Nh·∫ßm kh√≥a nh√†.', correct: false}, {text: 'M·∫•t kh√≥a.', correct: false}, {text: 'L·ªô kh√≥a private.', correct: false}, {text: 'D√πng sai th∆∞ vi·ªán.', correct: false}, {text: 'L·ªói ƒë√°nh m√°y.', correct: false}], explanation: 'Server ph·∫£i fix c·ª©ng thu·∫≠t to√°n mong ƒë·ª£i.' },
                { q: 'JWE (JSON Web Encryption) kh√°c JWT (JWS) th·∫ø n√†o?', options: [{text: 'JWE m√£ h√≥a n·ªôi dung (B·∫£o m·∫≠t), JWS ch·ªâ k√Ω n·ªôi dung (To√†n v·∫πn).', correct: true}, {text: 'JWT th∆∞·ªùng d√πng JWS (Signed), nh∆∞ng c√≥ th·ªÉ d√πng JWE (Encrypted) n·∫øu c·∫ßn gi·∫•u data.', correct: true}, {text: 'JWE c≈© h∆°n.', correct: false}, {text: 'JWS m·ªõi h∆°n.', correct: false}, {text: 'JWE kh√¥ng d√πng JSON.', correct: false}, {text: 'JWS d√πng XML.', correct: false}, {text: 'Gi·ªëng nhau.', correct: false}], explanation: 'JWT l√† ƒë·ªãnh d·∫°ng chung, JWS/JWE l√† c√°ch hi·ªán th·ª±c.' }
            ]
        };

        // Core Application Logic
        document.addEventListener('DOMContentLoaded', () => {
            // Accordion functionality
            document.querySelectorAll('.accordion-header').forEach(h => {
                h.addEventListener('click', () => {
                    const c = h.nextElementSibling;
                    const a = h.querySelector('.arrow');
                    c.classList.toggle('open');
                    a.style.transform = c.classList.contains('open') ? 'rotate(180deg)' : 'rotate(0deg)';
                });
            });

            // Mobile Menu
            document.getElementById('mobile-menu-btn').addEventListener('click', () => 
                document.getElementById('mobile-menu').classList.toggle('hidden'));

            // Quiz Variables
            let currentPool = [], currentIndex = 0, score = 0, wrongTries = 0, currentTopic = '';
            const modal = document.getElementById('quiz-modal');
            const shuffle = arr => arr.sort(() => Math.random() - 0.5);

            // Start Quiz Handler
            document.querySelectorAll('.start-quiz-btn').forEach(btn => {
                btn.addEventListener('click', e => {
                    const tid = e.target.dataset.topic;
                    const questions = quizDatabase[tid];
                    if (!questions) { alert("ƒêang c·∫≠p nh·∫≠t d·ªØ li·ªáu..."); return; }
                    
                    currentTopic = tid; score = 0; currentIndex = 0;
                    currentPool = shuffle([...questions]).slice(0, 10); // 10 random questions
                    
                    // UI Reset
                    document.getElementById('score-display').innerText = 0;
                    document.getElementById('score-display').className = 'text-lg font-bold text-slate-600';
                    modal.classList.remove('hidden');
                    document.getElementById('quiz-content').classList.remove('hidden');
                    document.getElementById('quiz-results').classList.add('hidden');
                    document.getElementById('next-question-btn').classList.add('hidden');
                    
                    loadQuestion();
                });
            });

            function loadQuestion() {
                const q = currentPool[currentIndex];
                document.getElementById('question-text').innerText = q.q;
                document.getElementById('question-counter').innerText = `${currentIndex + 1} / ${currentPool.length}`;
                document.getElementById('feedback-area').classList.add('hidden');
                document.getElementById('next-question-btn').classList.add('hidden');
                wrongTries = 0;

                const correct = q.options.find(o => o.correct);
                const wrongs = shuffle(q.options.filter(o => !o.correct)).slice(0, 3);
                const displayOpts = shuffle([correct, ...wrongs]);

                const container = document.getElementById('answer-options');
                container.innerHTML = '';
                
                displayOpts.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = 'quiz-option w-full text-left p-4 rounded-lg border-2 border-slate-200 hover:border-indigo-400 hover:bg-indigo-50 font-medium text-slate-700';
                    btn.innerText = opt.text;
                    btn.onclick = () => checkAnswer(btn, opt.correct, q.explanation, correct.text);
                    container.appendChild(btn);
                });
            }

            function checkAnswer(btn, isCorrect, explanation, correctText) {
                const all = document.querySelectorAll('.quiz-option');
                const feedback = document.getElementById('feedback-area');
                const nextBtn = document.getElementById('next-question-btn');
                const scoreDisp = document.getElementById('score-display');

                if (isCorrect) {
                    btn.classList.add('correct', 'border-green-500', 'bg-green-50', 'text-green-800');
                    if (wrongTries === 0) score += 1;
                    all.forEach(b => b.disabled = true);
                    
                    feedback.innerHTML = `<strong class="text-green-700">Ch√≠nh x√°c!</strong> ${explanation}`;
                    feedback.className = 'mt-6 p-4 rounded-lg text-sm bg-green-50 border border-green-200 text-green-800 block';
                    nextBtn.classList.remove('hidden');
                } else {
                    btn.classList.add('incorrect', 'border-red-300', 'bg-red-50');
                    btn.disabled = true;
                    score -= 0.5;
                    wrongTries++;
                    
                    if (wrongTries >= 3) {
                        all.forEach(b => {
                            b.disabled = true;
                            if (b.innerText === correctText) b.classList.add('correct', 'border-green-500');
                        });
                        feedback.innerHTML = `<strong class="text-red-700">Sai qu√° 3 l·∫ßn!</strong> ƒê√°p √°n ƒë√∫ng l√†: "${correctText}"<br>${explanation}`;
                        feedback.className = 'mt-6 p-4 rounded-lg text-sm bg-red-50 border border-red-200 text-red-800 block';
                        nextBtn.classList.remove('hidden');
                    }
                }
                scoreDisp.innerText = score;
                scoreDisp.className = score < 0 ? 'text-lg font-bold text-red-600' : 'text-lg font-bold text-green-600';
            }

            document.getElementById('next-question-btn').onclick = () => {
                currentIndex++;
                if (currentIndex < currentPool.length) loadQuestion();
                else {
                    document.getElementById('quiz-content').classList.add('hidden');
                    document.getElementById('quiz-results').classList.remove('hidden');
                    document.getElementById('final-score').innerText = score;
                    document.getElementById('next-question-btn').classList.add('hidden');
                }
            };

            document.getElementById('close-quiz-btn').onclick = () => modal.classList.add('hidden');
            document.getElementById('restart-quiz-btn').onclick = () => 
                document.querySelector(`button[data-topic="${currentTopic}"]`).click();
        });
    </script>
</body>
</html>